<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DealershipAI - Executive Command Center</title>

    <!-- Core Web Vitals Library -->
    <script type="module">
        import {onCLS, onFID, onLCP, onFCP, onTTFB, onINP} from 'https://unpkg.com/web-vitals@3/dist/web-vitals.js';

        window.webVitalsData = {
            cls: null,
            fid: null,
            lcp: null,
            fcp: null,
            ttfb: null,
            inp: null
        };

        onCLS((metric) => {
            window.webVitalsData.cls = metric.value;
            console.log('CLS:', metric.value);
        });

        onFID((metric) => {
            window.webVitalsData.fid = metric.value;
            console.log('FID:', metric.value);
        });

        onLCP((metric) => {
            window.webVitalsData.lcp = metric.value;
            console.log('LCP:', metric.value);
        });

        onFCP((metric) => {
            window.webVitalsData.fcp = metric.value;
            console.log('FCP:', metric.value);
        });

        onTTFB((metric) => {
            window.webVitalsData.ttfb = metric.value;
            console.log('TTFB:', metric.value);
        });

        onINP((metric) => {
            window.webVitalsData.inp = metric.value;
            console.log('INP:', metric.value);
        });
    </script>

    <style>
        :root {
            /* Apple Color System */
            --apple-blue: #007AFF;
            --apple-blue-light: #5AC8FA;
            --apple-blue-dark: #0051D8;
            --apple-green: #34C759;
            --apple-orange: #FF9500;
            --apple-red: #FF3B30;
            --apple-purple: #AF52DE;
            --apple-pink: #FF2D92;
            --apple-yellow: #FFCC00;

            /* Grayscale System */
            --white: #FFFFFF;
            --gray-50: #FAFAFA;
            --gray-100: #F5F5F7;
            --gray-200: #E5E5EA;
            --gray-300: #D1D1D6;
            --gray-400: #C7C7CC;
            --gray-500: #8E8E93;
            --gray-600: #636366;
            --gray-700: #48484A;
            --gray-800: #1C1C1E;
            --gray-900: #000000;

            /* Text Colors */
            --text-primary: #1D1D1F;
            --text-secondary: #86868B;
            --text-tertiary: #C7C7CC;

            /* Shadows */
            --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);

            /* Border Radius */
            --radius-sm: 6px;
            --radius: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --radius-full: 9999px;

            /* Transitions */
            --transition-fast: 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 0.5s cubic-bezier(0.4, 0, 0.2, 1);

            /* Spacing */
            --space-1: 4px;
            --space-2: 8px;
            --space-3: 12px;
            --space-4: 16px;
            --space-5: 20px;
            --space-6: 24px;
            --space-8: 32px;
            --space-10: 40px;
            --space-12: 48px;
            --space-16: 64px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', system-ui, sans-serif;
            background: var(--white);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Container System */
        .cupertino-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--space-8) var(--space-6);
        }

        /* Apple Header */
        .cupertino-header {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: saturate(180%) blur(20px);
            -webkit-backdrop-filter: saturate(180%) blur(20px);
            border-bottom: 0.5px solid var(--gray-200);
            padding: var(--space-4) 0;
            position: sticky;
            top: 0;
            z-index: 100;
            margin-bottom: var(--space-8);
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--space-6);
        }

        .brand-section {
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        .apple-logo {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--apple-blue), var(--apple-blue-light));
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-weight: 600;
            font-size: 14px;
            transition: var(--transition-fast);
        }

        .apple-logo:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow);
        }

        .brand-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            letter-spacing: -0.01em;
        }

        .brand-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 400;
        }

        .header-badges {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        .apple-badge {
            padding: var(--space-2) var(--space-4);
            background: var(--gray-100);
            border-radius: var(--radius-full);
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
            border: 0.5px solid var(--gray-200);
        }

        .apple-badge.pro {
            background: var(--apple-blue);
            color: var(--white);
            border: none;
        }

        .status-section {
            display: flex;
            align-items: center;
            gap: var(--space-5);
        }

        .live-indicator {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2) var(--space-3);
            background: var(--gray-50);
            border-radius: var(--radius-full);
            border: 0.5px solid var(--gray-200);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            background: var(--apple-green);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .status-text {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* Apple Navigation */
        .cupertino-nav {
            background: var(--white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            border: 0.5px solid var(--gray-200);
            padding: var(--space-2);
            margin-bottom: var(--space-8);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .nav-tabs {
            display: flex;
            gap: var(--space-1);
            min-width: min-content;
        }

        .apple-tab {
            padding: var(--space-3) var(--space-4);
            border-radius: var(--radius);
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition-fast);
            white-space: nowrap;
            position: relative;
            background: transparent;
            border: none;
        }

        .apple-tab:hover {
            color: var(--text-primary);
            background: var(--gray-50);
        }

        .apple-tab.active {
            color: var(--apple-blue);
            background: rgba(0, 122, 255, 0.1);
        }

        .apple-tab.active::before {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            background: var(--apple-blue);
            border-radius: 50%;
        }

        /* Main Content */
        .cupertino-main {
            background: var(--white);
            min-height: 70vh;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeInUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Consolidated Grid & Section Styles */
        .section {
            margin-bottom: var(--space-16);
        }

        .section-header {
            font-size: 28px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-8);
            letter-spacing: -0.02em;
            line-height: 1.2;
        }

        .section-subheader {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: var(--space-6);
            font-weight: 400;
        }

        .apple-grid {
            display: grid;
            gap: var(--space-6);
        }

        .grid-2 { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
        .grid-3 { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }
        .grid-4 { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }

        /* Consolidated Card Styles */
        .apple-card {
            background: var(--white);
            border-radius: var(--radius-lg);
            border: 0.5px solid var(--gray-200);
            transition: var(--transition);
            overflow: hidden;
            position: relative;
        }

        .apple-card:hover, .apple-card.clickable:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--gray-300);
        }

        .apple-card.clickable {
            cursor: pointer;
        }

        .apple-card.clickable:active {
            transform: scale(0.98) translateY(-2px);
        }

        /* Metric Cards */
        .metric-card {
            padding: var(--space-8);
            text-align: left;
        }

        .metric-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-6);
        }

        .metric-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius);
            background: var(--gray-50);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .metric-badge {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: var(--space-1) var(--space-2);
            background: var(--gray-100);
            border-radius: var(--radius-sm);
        }

        .metric-label {
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 500;
            margin-bottom: var(--space-2);
        }

        .metric-value {
            font-size: 36px;
            font-weight: 700;
            color: var(--text-primary);
            line-height: 1.1;
            margin-bottom: var(--space-4);
            font-variant-numeric: tabular-nums;
        }

        .metric-change {
            font-size: 13px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: var(--space-1);
        }

        .metric-change.positive {
            color: var(--apple-green);
        }

        .metric-change.negative {
            color: var(--apple-red);
        }

        .metric-change::before {
            content: '↗';
            font-size: 12px;
        }

        .metric-change.negative::before {
            content: '↘';
        }

        /* Progress Bars */
        .progress-container {
            margin: var(--space-4) 0;
        }

        .progress-bar {
            height: 4px;
            background: var(--gray-100);
            border-radius: var(--radius-full);
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--apple-blue);
            border-radius: var(--radius-full);
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 8px;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4));
            border-radius: var(--radius-full);
        }

        /* Visibility Score Cards */
        .visibility-card {
            padding: var(--space-8);
            background: linear-gradient(135deg, var(--gray-50) 0%, var(--white) 100%);
            position: relative;
        }

        .visibility-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            border-radius: var(--radius-full);
        }

        .visibility-card.seo::before {
            background: var(--apple-blue);
        }

        .visibility-card.aeo::before {
            background: var(--apple-orange);
        }

        .visibility-card.geo::before {
            background: var(--apple-red);
        }

        .score-display {
            display: flex;
            align-items: baseline;
            gap: var(--space-2);
            margin-bottom: var(--space-4);
        }

        .score-value {
            font-size: 48px;
            font-weight: 800;
            line-height: 1;
            font-variant-numeric: tabular-nums;
        }

        .score-max {
            font-size: 20px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .formula-hint {
            font-size: 12px;
            color: var(--text-tertiary);
            font-style: italic;
            margin-top: var(--space-2);
        }

        /* Consolidated Button & Animation Styles */
        .apple-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
            padding: var(--space-3) var(--space-5);
            border-radius: var(--radius-full);
            font-size: 14px;
            font-weight: 500;
            text-decoration: none;
            cursor: pointer;
            transition: var(--transition-fast);
            border: none;
            position: relative;
            overflow: hidden;
        }

        .apple-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }

        .apple-btn:hover::before {
            left: 100%;
        }

        .apple-btn:hover {
            transform: translateY(-1px);
        }

        .btn-primary {
            background: var(--apple-blue);
            color: var(--white);
            box-shadow: var(--shadow);
        }

        .btn-primary:hover {
            background: var(--apple-blue-dark);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--gray-100);
            color: var(--text-primary);
            border: 0.5px solid var(--gray-200);
        }

        .btn-secondary:hover {
            background: var(--gray-200);
        }

        .btn-ghost {
            background: transparent;
            color: var(--apple-blue);
        }

        .btn-ghost:hover {
            background: rgba(0, 122, 255, 0.1);
        }

        /* Consolidated Chart & Feed Styles */
        .chart-container, .live-feed {
            background: var(--gray-50);
            border-radius: var(--radius-lg);
            border: 0.5px solid var(--gray-200);
        }

        .chart-container {
            padding: var(--space-8);
        }

        .chart-header, .feed-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: var(--space-6);
        }

        .chart-title, .feed-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .feed-title {
            font-size: 18px;
        }

        .chart-placeholder {
            height: 240px;
            background: var(--white);
            border-radius: var(--radius);
            border: 1px dashed var(--gray-300);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
        }

        .live-feed {
            background: var(--white);
        }

        .feed-header {
            padding: var(--space-6);
            border-bottom: 0.5px solid var(--gray-200);
        }

        .feed-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .feed-content {
            padding: 0;
        }

        .feed-item {
            padding: var(--space-4) var(--space-6);
            border-bottom: 0.5px solid var(--gray-100);
            display: flex;
            align-items: center;
            justify-content: between;
            transition: var(--transition-fast);
            position: relative;
        }

        .feed-item:last-child {
            border-bottom: none;
        }

        .feed-item:hover {
            background: var(--gray-50);
        }

        .feed-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: transparent;
            transition: var(--transition-fast);
        }

        .feed-item.success::before { background: var(--apple-green); }
        .feed-item.warning::before { background: var(--apple-orange); }
        .feed-item.error::before { background: var(--apple-red); }

        .feed-text {
            font-size: 14px;
            color: var(--text-primary);
            font-weight: 400;
        }

        .feed-time {
            font-size: 12px;
            color: var(--text-secondary);
            font-variant-numeric: tabular-nums;
        }

        /* Modals */
        .cupertino-modal {
            position: fixed;
            inset: 0;
            z-index: 1000;
            display: none;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }

        .cupertino-modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
            animation: modalFadeIn 0.3s ease-out;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--white);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-xl);
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow: hidden;
            animation: modalSlideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes modalSlideUp {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(40px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .modal-header {
            padding: var(--space-6);
            border-bottom: 0.5px solid var(--gray-200);
            display: flex;
            align-items: center;
            justify-content: between;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .modal-close {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--gray-100);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .modal-close:hover {
            background: var(--gray-200);
        }

        .modal-body {
            padding: var(--space-6);
            overflow-y: auto;
            max-height: 70vh;
        }

        /* Health Score Display */
        .health-score {
            text-align: center;
            padding: var(--space-10) var(--space-6);
            background: var(--gray-50);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-8);
        }

        .health-value {
            font-size: 72px;
            font-weight: 800;
            color: var(--apple-blue);
            line-height: 1;
            margin-bottom: var(--space-2);
            font-variant-numeric: tabular-nums;
        }

        .health-label {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: var(--space-6);
        }

        .health-progress {
            width: 200px;
            height: 6px;
            background: var(--gray-200);
            border-radius: var(--radius-full);
            margin: 0 auto;
            overflow: hidden;
        }

        .health-bar {
            height: 100%;
            background: var(--apple-blue);
            border-radius: var(--radius-full);
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .cupertino-container {
                padding: var(--space-4);
            }

            .header-content {
                flex-direction: column;
                gap: var(--space-4);
                text-align: center;
            }

            .brand-section {
                flex-direction: column;
                gap: var(--space-2);
            }

            .header-badges {
                flex-wrap: wrap;
                justify-content: center;
            }

            .nav-tabs {
                justify-content: flex-start;
                padding-bottom: var(--space-2);
            }

            .grid-2, .grid-3, .grid-4 {
                grid-template-columns: 1fr;
            }

            .section-header {
                font-size: 24px;
            }

            .metric-value {
                font-size: 28px;
            }

            .score-value {
                font-size: 36px;
            }

            .modal-content {
                width: 95%;
                margin: var(--space-4);
                max-height: 85vh;
            }
        }

        /* Loading States */
        .skeleton {
            background: linear-gradient(90deg, var(--gray-100) 25%, var(--gray-200) 50%, var(--gray-100) 75%);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        /* Focus States */
        .apple-tab:focus-visible,
        .apple-btn:focus-visible,
        .apple-card.clickable:focus-visible {
            outline: 2px solid var(--apple-blue);
            outline-offset: 2px;
        }

        /* Selection */
        ::selection {
            background: rgba(0, 122, 255, 0.2);
        }
    </style>
</head>
<body>
    <div class="cupertino-container">
        <!-- Apple Header -->
        <header class="cupertino-header">
            <div class="header-content">
                <div class="brand-section">
                    <div class="apple-logo">dAI</div>
                    <div>
                        <div class="brand-title">DealershipAI</div>
                        <div class="brand-subtitle">Executive Command Center</div>
                    </div>
                    <div class="header-badges">
                        <div class="apple-badge">Premium Auto Dealership</div>
                        <div class="apple-badge">Cape Coral, FL</div>
                        <div class="apple-badge pro">PRO</div>
                    </div>
                </div>
                <div class="status-section">
                    <div class="live-indicator">
                        <div class="status-dot"></div>
                        <span class="status-text">Live</span>
                    </div>
                    <div class="status-text" id="current-time">Jan 10, 2025 2:45 PM</div>
                </div>
            </div>
        </header>

        <!-- Apple Navigation -->
        <nav class="cupertino-nav">
            <div class="nav-tabs">
                <button class="apple-tab active" onclick="switchTab('overview')">Overview</button>
                <button class="apple-tab" onclick="switchTab('ai-health')">AI Health</button>
                <button class="apple-tab" onclick="switchTab('website')">Website</button>
                <button class="apple-tab" onclick="switchTab('schema')">Schema</button>
                <button class="apple-tab" onclick="switchTab('reviews')">Reviews</button>
                <button class="apple-tab" onclick="switchTab('mystery-shop')">Mystery Shop</button>
                <button class="apple-tab" onclick="switchTab('predictive')">Predictive</button>
                <button class="apple-tab" onclick="switchTab('geo-sge')">GEO/SGE</button>
                <button class="apple-tab" onclick="switchTab('settings')">Settings</button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="cupertino-main">
            <!-- Overview Tab -->
            <div id="overview" class="tab-content active">
                <!-- Visibility Scores Section -->
                <section class="section">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-6);">
                        <div>
                            <h1 class="section-header" style="margin-bottom: var(--space-2);">Visibility Performance</h1>
                            <p class="section-subheader" style="margin-bottom: 0;">Real-time weighted visibility scores across search channels</p>
                        </div>
                        <div style="display: flex; align-items: center; gap: var(--space-3);">
                            <div style="display: flex; align-items: center; gap: var(--space-2); padding: var(--space-2) var(--space-4); background: var(--gray-50); border-radius: var(--radius-full); border: 0.5px solid var(--gray-200);">
                                <div style="width: 6px; height: 6px; background: var(--apple-green); border-radius: 50%; animation: pulse 2s infinite;"></div>
                                <div style="font-size: 12px; color: var(--text-secondary); font-weight: 500;">7/8 Platforms Connected</div>
                            </div>
                            <div style="display: flex; align-items: center; gap: var(--space-2); padding: var(--space-2) var(--space-4); background: var(--gray-50); border-radius: var(--radius-full); border: 0.5px solid var(--gray-200);">
                                <div style="font-size: 12px;">🔗</div>
                                <div style="font-size: 12px; color: var(--text-secondary); font-weight: 500;">Ecosystem Health: 94%</div>
                            </div>
                        </div>
                    </div>

                    <div class="apple-grid grid-3">
                        <div class="apple-card clickable visibility-card seo" onclick="openModal('seo-modal')">
                            <div class="metric-header">
                                <div class="metric-icon" style="background: rgba(0, 122, 255, 0.1); color: var(--apple-blue);">🔍</div>
                                <div class="metric-badge">Traditional</div>
                            </div>
                            <div class="metric-label">SEO Visibility</div>
                            <div class="score-display">
                                <div class="score-value" style="color: var(--apple-blue);">87.3</div>
                                <div class="score-max">/100</div>
                            </div>
                            <div class="progress-container">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 87.3%"></div>
                                </div>
                            </div>
                            <div class="metric-change positive">Strong performance</div>
                            <div class="formula-hint">Mentions 20% • Citations 25% • Sentiment 15% • Content 25% • Share 15%</div>
                        </div>

                        <div class="apple-card clickable visibility-card aeo" onclick="openModal('aeo-modal')">
                            <div class="metric-header">
                                <div class="metric-icon" style="background: rgba(255, 149, 0, 0.1); color: var(--apple-orange);">🎯</div>
                                <div class="metric-badge">Answer Engines</div>
                            </div>
                            <div class="metric-label">AEO Visibility</div>
                            <div class="score-display">
                                <div class="score-value" style="color: var(--apple-orange);">73.8</div>
                                <div class="score-max">/100</div>
                            </div>
                            <div class="progress-container">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 73.8%; background: var(--apple-orange)"></div>
                                </div>
                            </div>
                            <div class="metric-change positive">Improving</div>
                            <div class="formula-hint">Mentions 30% • Citations 35% • Sentiment 10% • Content 15% • Share 10%</div>
                        </div>

                        <div class="apple-card clickable visibility-card geo" onclick="openModal('geo-modal')">
                            <div class="metric-header">
                                <div class="metric-icon" style="background: rgba(255, 59, 48, 0.1); color: var(--apple-red);">🤖</div>
                                <div class="metric-badge">AI Models</div>
                            </div>
                            <div class="metric-label">GEO Visibility</div>
                            <div class="score-display">
                                <div class="score-value" style="color: var(--apple-red);">65.2</div>
                                <div class="score-max">/100</div>
                            </div>
                            <div class="progress-container">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 65.2%; background: var(--apple-red)"></div>
                                </div>
                            </div>
                            <div class="metric-change negative">Needs attention</div>
                            <div class="formula-hint">Mentions 25% • Citations 30% • Sentiment 20% • Content 15% • Share 10%</div>
                        </div>
                    </div>
                </section>

                <!-- Key Metrics Section -->
                <section class="section">
                    <h2 class="section-header">Performance Overview</h2>

                    <div class="apple-grid grid-4">
                        <div class="apple-card metric-card">
                            <div class="metric-header">
                                <div class="metric-icon" style="background: rgba(52, 199, 89, 0.1); color: var(--apple-green);">💰</div>
                                <div class="metric-badge">Q1 2025</div>
                            </div>
                            <div class="metric-label">Revenue at Risk</div>
                            <div class="metric-value">$367K</div>
                            <div class="progress-container">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 75%; background: var(--apple-green)"></div>
                                </div>
                            </div>
                            <div class="metric-change positive">Projected growth</div>
                        </div>

                        <div class="apple-card metric-card">
                            <div class="metric-header">
                                <div class="metric-icon" style="background: rgba(0, 122, 255, 0.1); color: var(--apple-blue);">📊</div>
                                <div class="metric-badge">Live</div>
                            </div>
                            <div class="metric-label">Search Visibility</div>
                            <div class="metric-value">92%</div>
                            <div class="progress-container">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 92%"></div>
                                </div>
                            </div>
                            <div class="metric-change positive">Active monitoring</div>
                        </div>

                        <div class="apple-card metric-card">
                            <div class="metric-header">
                                <div class="metric-icon" style="background: rgba(255, 149, 0, 0.1); color: var(--apple-orange);">🌐</div>
                                <div class="metric-badge">Technical</div>
                            </div>
                            <div class="metric-label">Website Health</div>
                            <div class="metric-value">87</div>
                            <div class="progress-container">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 87%; background: var(--apple-orange)"></div>
                                </div>
                            </div>
                            <div class="metric-change negative">3 issues</div>
                        </div>

                        <div class="apple-card metric-card">
                            <div class="metric-header">
                                <div class="metric-icon" style="background: rgba(175, 82, 222, 0.1); color: var(--apple-purple);">🕵️</div>
                                <div class="metric-badge">Manual</div>
                            </div>
                            <div class="metric-label">Mystery Shop</div>
                            <div class="metric-value">78</div>
                            <div class="progress-container">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 78%; background: var(--apple-purple)"></div>
                                </div>
                            </div>
                            <div class="metric-change">2 weeks ago</div>
                        </div>
                    </div>
                </section>

                <!-- Executive Intelligence Section -->
                <section class="section">
                    <h2 class="section-header">Executive Intelligence</h2>
                    <p class="section-subheader">Strategic insights and market intelligence for leadership decisions</p>

                    <div class="apple-grid grid-2">
                        <!-- ROI Attribution Dashboard -->
                        <div class="apple-card" style="padding: var(--space-8);">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-6);">
                                <div>
                                    <div style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-1);">ROI Attribution</div>
                                    <div style="font-size: 13px; color: var(--text-secondary);">Visibility impact on actual revenue</div>
                                </div>
                                <div style="font-size: 24px;">💰</div>
                            </div>

                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-4); margin-bottom: var(--space-6);">
                                <div style="text-align: center;">
                                    <div style="font-size: 24px; font-weight: 700; color: var(--apple-green); margin-bottom: var(--space-1);">$2.3M</div>
                                    <div style="font-size: 12px; color: var(--text-secondary);">SEO Attribution</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 24px; font-weight: 700; color: var(--apple-blue); margin-bottom: var(--space-1);">$890K</div>
                                    <div style="font-size: 12px; color: var(--text-secondary);">AI Citation Value</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 24px; font-weight: 700; color: var(--apple-orange); margin-bottom: var(--space-1);">$567K</div>
                                    <div style="font-size: 12px; color: var(--text-secondary);">GMB Performance</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 24px; font-weight: 700; color: var(--apple-purple); margin-bottom: var(--space-1);">32%</div>
                                    <div style="font-size: 12px; color: var(--text-secondary);">Total ROI</div>
                                </div>
                            </div>

                            <div style="padding: var(--space-4); background: var(--gray-50); border-radius: var(--radius); border-left: 3px solid var(--apple-green);">
                                <div style="font-size: 13px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-1);">Key Insight</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">AI citations drive 23% higher conversion rates than traditional search</div>
                            </div>
                        </div>

                        <!-- Market Opportunity Scoring -->
                        <div class="apple-card" style="padding: var(--space-8);">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-6);">
                                <div>
                                    <div style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-1);">Market Opportunities</div>
                                    <div style="font-size: 13px; color: var(--text-secondary);">AI-powered opportunity identification</div>
                                </div>
                                <div style="font-size: 24px;">🎯</div>
                            </div>

                            <div style="display: flex; flex-direction: column; gap: var(--space-4);">
                                <div style="display: flex; align-items: center; justify-content: space-between; padding: var(--space-3); background: linear-gradient(135deg, rgba(52, 199, 89, 0.1), transparent); border-radius: var(--radius); border-left: 3px solid var(--apple-green);">
                                    <div>
                                        <div style="font-size: 13px; font-weight: 600; color: var(--text-primary);">Electric Vehicle Market</div>
                                        <div style="font-size: 11px; color: var(--text-secondary);">High search volume, low competition</div>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 12px; font-weight: 600; color: var(--apple-green);">94</div>
                                        <div style="font-size: 10px; color: var(--text-secondary);">score</div>
                                    </div>
                                </div>

                                <div style="display: flex; align-items: center; justify-content: space-between; padding: var(--space-3); background: linear-gradient(135deg, rgba(255, 149, 0, 0.1), transparent); border-radius: var(--radius); border-left: 3px solid var(--apple-orange);">
                                    <div>
                                        <div style="font-size: 13px; font-weight: 600; color: var(--text-primary);">Service After Hours</div>
                                        <div style="font-size: 11px; color: var(--text-secondary);">Emerging demand in voice search</div>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 12px; font-weight: 600; color: var(--apple-orange);">78</div>
                                        <div style="font-size: 10px; color: var(--text-secondary);">score</div>
                                    </div>
                                </div>

                                <div style="display: flex; align-items: center; justify-content: space-between; padding: var(--space-3); background: linear-gradient(135deg, rgba(0, 122, 255, 0.1), transparent); border-radius: var(--radius); border-left: 3px solid var(--apple-blue);">
                                    <div>
                                        <div style="font-size: 13px; font-weight: 600; color: var(--text-primary);">Lease Return Program</div>
                                        <div style="font-size: 11px; color: var(--text-secondary);">Growing AI citation opportunity</div>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 12px; font-weight: 600; color: var(--apple-blue);">71</div>
                                        <div style="font-size: 10px; color: var(--text-secondary);">score</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Premium Command Center Section -->
                <section class="section">
                    <h2 class="section-header">Command Center</h2>
                    <p class="section-subheader">One-click orchestration across your entire digital ecosystem</p>

                    <div class="apple-grid grid-4">
                        <!-- One-Click Fixes -->
                        <div class="apple-card clickable" style="padding: var(--space-6); text-align: center; background: linear-gradient(135deg, rgba(255, 59, 48, 0.05), var(--white)); border-left: 3px solid var(--apple-red);">
                            <div style="font-size: 32px; margin-bottom: var(--space-3);">🚨</div>
                            <div style="font-size: 14px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-2);">Emergency Fixes</div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--space-4);">Auto-resolve critical issues</div>
                            <div style="display: flex; flex-direction: column; gap: var(--space-2);">
                                <button class="apple-btn btn-primary" style="font-size: 12px; width: 100%;">Fix All Critical</button>
                                <div style="font-size: 10px; color: var(--text-tertiary);">3 issues detected</div>
                            </div>
                        </div>

                        <!-- Bulk Actions -->
                        <div class="apple-card clickable" style="padding: var(--space-6); text-align: center; background: linear-gradient(135deg, rgba(255, 149, 0, 0.05), var(--white)); border-left: 3px solid var(--apple-orange);">
                            <div style="font-size: 32px; margin-bottom: var(--space-3);">⚡</div>
                            <div style="font-size: 14px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-2);">Bulk Actions</div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--space-4);">Mass updates across platforms</div>
                            <div style="display: flex; flex-direction: column; gap: var(--space-2);">
                                <button class="apple-btn btn-secondary" style="font-size: 12px; width: 100%;">Update All Profiles</button>
                                <div style="font-size: 10px; color: var(--text-tertiary);">7 platforms ready</div>
                            </div>
                        </div>

                        <!-- Campaign Orchestration -->
                        <div class="apple-card clickable" style="padding: var(--space-6); text-align: center; background: linear-gradient(135deg, rgba(0, 122, 255, 0.05), var(--white)); border-left: 3px solid var(--apple-blue);">
                            <div style="font-size: 32px; margin-bottom: var(--space-3);">🎺</div>
                            <div style="font-size: 14px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-2);">Campaign Launch</div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--space-4);">Coordinated multi-channel</div>
                            <div style="display: flex; flex-direction: column; gap: var(--space-2);">
                                <button class="apple-btn btn-secondary" style="font-size: 12px; width: 100%;">Launch Campaign</button>
                                <div style="font-size: 10px; color: var(--text-tertiary);">6 channels selected</div>
                            </div>
                        </div>

                        <!-- AI Content Optimization -->
                        <div class="apple-card clickable" style="padding: var(--space-6); text-align: center; background: linear-gradient(135deg, rgba(52, 199, 89, 0.05), var(--white)); border-left: 3px solid var(--apple-green);">
                            <div style="font-size: 32px; margin-bottom: var(--space-3);">🤖</div>
                            <div style="font-size: 14px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-2);">AI Optimization</div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--space-4);">Content for AI training</div>
                            <div style="display: flex; flex-direction: column; gap: var(--space-2);">
                                <button class="apple-btn btn-secondary" style="font-size: 12px; width: 100%;">Optimize Content</button>
                                <div style="font-size: 10px; color: var(--text-tertiary);">12 pages ready</div>
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Command Controls -->
                    <div style="margin-top: var(--space-8); padding: var(--space-6); background: linear-gradient(135deg, var(--gray-50), var(--white)); border-radius: var(--radius-lg); border: 0.5px solid var(--gray-200);">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-4);">
                            <div>
                                <div style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-1);">Advanced Operations</div>
                                <div style="font-size: 13px; color: var(--text-secondary);">Enterprise-grade automation and control</div>
                            </div>
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <div style="width: 6px; height: 6px; background: var(--apple-green); border-radius: 50%;"></div>
                                <div style="font-size: 12px; color: var(--apple-green); font-weight: 500;">All Systems Ready</div>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-3);">
                            <button class="apple-btn btn-secondary" style="justify-content: flex-start; gap: var(--space-3);">
                                <div style="font-size: 16px;">🔄</div>
                                <div style="text-align: left;">
                                    <div style="font-size: 12px; font-weight: 600;">Full Ecosystem Sync</div>
                                    <div style="font-size: 10px; opacity: 0.7;">All platforms & data</div>
                                </div>
                            </button>

                            <button class="apple-btn btn-secondary" style="justify-content: flex-start; gap: var(--space-3);">
                                <div style="font-size: 16px;">🎯</div>
                                <div style="text-align: left;">
                                    <div style="font-size: 12px; font-weight: 600;">Competitor Response</div>
                                    <div style="font-size: 10px; opacity: 0.7;">Automated counter-strategy</div>
                                </div>
                            </button>

                            <button class="apple-btn btn-secondary" style="justify-content: flex-start; gap: var(--space-3);">
                                <div style="font-size: 16px;">📊</div>
                                <div style="text-align: left;">
                                    <div style="font-size: 12px; font-weight: 600;">Executive Report</div>
                                    <div style="font-size: 10px; opacity: 0.7;">Board-ready insights</div>
                                </div>
                            </button>

                            <button class="apple-btn btn-secondary" style="justify-content: flex-start; gap: var(--space-3);">
                                <div style="font-size: 16px;">🔒</div>
                                <div style="text-align: left;">
                                    <div style="font-size: 12px; font-weight: 600;">Crisis Management</div>
                                    <div style="font-size: 10px; opacity: 0.7;">Emergency protocols</div>
                                </div>
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Focus Areas Section -->
                <section class="section">
                    <h2 class="section-header">Priority Focus</h2>

                    <div class="apple-grid grid-3">
                        <div class="apple-card clickable" style="padding: var(--space-6); background: linear-gradient(135deg, rgba(255, 59, 48, 0.05) 0%, var(--white) 100%); border-left: 3px solid var(--apple-red);">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-3);">
                                <div style="display: flex; align-items: center; gap: var(--space-2);">
                                    <div style="width: 8px; height: 8px; background: var(--apple-red); border-radius: 50%;"></div>
                                    <div style="font-size: 12px; font-weight: 600; color: var(--apple-red); text-transform: uppercase;">Critical</div>
                                </div>
                                <div style="font-size: 18px;">🤖</div>
                            </div>
                            <div style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-2);">GEO Citations</div>
                            <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: var(--space-4);">AI models citing 67% below target</div>
                            <div style="display: flex; gap: var(--space-2);">
                                <button class="apple-btn btn-primary" style="font-size: 12px; padding: var(--space-2) var(--space-3);">Fix Now</button>
                                <button class="apple-btn btn-ghost" style="font-size: 12px; padding: var(--space-2) var(--space-3);">Details</button>
                            </div>
                        </div>

                        <div class="apple-card clickable" style="padding: var(--space-6); background: linear-gradient(135deg, rgba(255, 149, 0, 0.05) 0%, var(--white) 100%); border-left: 3px solid var(--apple-orange);">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-3);">
                                <div style="display: flex; align-items: center; gap: var(--space-2);">
                                    <div style="width: 8px; height: 8px; background: var(--apple-orange); border-radius: 50%;"></div>
                                    <div style="font-size: 12px; font-weight: 600; color: var(--apple-orange); text-transform: uppercase;">Important</div>
                                </div>
                                <div style="font-size: 18px;">🔍</div>
                            </div>
                            <div style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-2);">Schema Markup</div>
                            <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: var(--space-4);">3 pages missing AutoDealer schema</div>
                            <div style="display: flex; gap: var(--space-2);">
                                <button class="apple-btn btn-secondary" style="font-size: 12px; padding: var(--space-2) var(--space-3);">Schedule</button>
                                <button class="apple-btn btn-ghost" style="font-size: 12px; padding: var(--space-2) var(--space-3);">View</button>
                            </div>
                        </div>

                        <div class="apple-card clickable" style="padding: var(--space-6); background: linear-gradient(135deg, rgba(52, 199, 89, 0.05) 0%, var(--white) 100%); border-left: 3px solid var(--apple-green);">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-3);">
                                <div style="display: flex; align-items: center; gap: var(--space-2);">
                                    <div style="width: 8px; height: 8px; background: var(--apple-green); border-radius: 50%;"></div>
                                    <div style="font-size: 12px; font-weight: 600; color: var(--apple-green); text-transform: uppercase;">Maintain</div>
                                </div>
                                <div style="font-size: 18px;">⭐</div>
                            </div>
                            <div style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-2);">Review Response</div>
                            <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: var(--space-4);">92% rate performing well</div>
                            <div style="display: flex; gap: var(--space-2);">
                                <button class="apple-btn btn-secondary" style="font-size: 12px; padding: var(--space-2) var(--space-3);">Monitor</button>
                                <button class="apple-btn btn-ghost" style="font-size: 12px; padding: var(--space-2) var(--space-3);">History</button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Analytics Section -->
                <section class="section">
                    <h2 class="section-header">Analytics</h2>

                    <div class="apple-grid grid-2">
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">Monthly Impression Trend</div>
                                <button class="apple-btn btn-ghost">Export</button>
                            </div>
                            <div class="chart-placeholder">
                                <div style="display: flex; flex-direction: column; align-items: center; gap: var(--space-2);">
                                    <div style="font-size: 18px;">📈</div>
                                    <div style="font-size: 14px; font-weight: 500; color: var(--text-primary);">Funnel Impression Analytics</div>
                                    <div style="display: flex; gap: var(--space-4); font-size: 12px; color: var(--text-secondary);">
                                        <span style="display: flex; align-items: center; gap: var(--space-1);"><div style="width: 8px; height: 8px; background: var(--apple-blue); border-radius: 50%;"></div>Upper Funnel</span>
                                        <span style="display: flex; align-items: center; gap: var(--space-1);"><div style="width: 8px; height: 8px; background: var(--apple-orange); border-radius: 50%;"></div>Mid Funnel</span>
                                        <span style="display: flex; align-items: center; gap: var(--space-1);"><div style="width: 8px; height: 8px; background: var(--apple-green); border-radius: 50%;"></div>Lower Funnel</span>
                                    </div>
                                    <div style="font-size: 11px; color: var(--text-tertiary); text-align: center; margin-top: var(--space-2);">Brand Awareness → Shopping Intent → Purchase Ready</div>
                                </div>
                            </div>
                        </div>

                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">Traffic Sources</div>
                                <button class="apple-btn btn-ghost">Details</button>
                            </div>
                            <div class="chart-placeholder">🥧 Traffic distribution chart</div>
                        </div>
                    </div>
                </section>

                <!-- Quick Actions Section -->
                <section class="section">
                    <h2 class="section-header">Quick Actions</h2>

                    <div class="apple-grid grid-4">
                        <div class="apple-card clickable" style="padding: var(--space-6); text-align: center; background: linear-gradient(135deg, var(--gray-50) 0%, var(--white) 100%);">
                            <div style="font-size: 32px; margin-bottom: var(--space-3);">🚀</div>
                            <div style="font-size: 14px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-2);">Run Audit</div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--space-4);">Comprehensive analysis</div>
                            <button class="apple-btn btn-primary" style="font-size: 12px; width: 100%;">Start Now</button>
                        </div>

                        <div class="apple-card clickable" style="padding: var(--space-6); text-align: center; background: linear-gradient(135deg, var(--gray-50) 0%, var(--white) 100%);">
                            <div style="font-size: 32px; margin-bottom: var(--space-3);">📊</div>
                            <div style="font-size: 14px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-2);">Generate Report</div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--space-4);">Executive summary</div>
                            <button class="apple-btn btn-secondary" style="font-size: 12px; width: 100%;">Create</button>
                        </div>

                        <div class="apple-card clickable" style="padding: var(--space-6); text-align: center; background: linear-gradient(135deg, var(--gray-50) 0%, var(--white) 100%);">
                            <div style="font-size: 32px; margin-bottom: var(--space-3);">🔧</div>
                            <div style="font-size: 14px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-2);">Fix Issues</div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--space-4);">Auto-remediation</div>
                            <button class="apple-btn btn-secondary" style="font-size: 12px; width: 100%;">Fix All</button>
                        </div>

                        <div class="apple-card clickable" style="padding: var(--space-6); text-align: center; background: linear-gradient(135deg, var(--gray-50) 0%, var(--white) 100%);">
                            <div style="font-size: 32px; margin-bottom: var(--space-3);">📈</div>
                            <div style="font-size: 14px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-2);">View Trends</div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--space-4);">Historical data</div>
                            <button class="apple-btn btn-secondary" style="font-size: 12px; width: 100%;">Explore</button>
                        </div>
                    </div>
                </section>

                <!-- Connected Ecosystem Section -->
                <section class="section">
                    <h2 class="section-header">Connected Ecosystem</h2>
                    <p class="section-subheader">Unified intelligence across your entire digital stack</p>

                    <div class="apple-grid grid-3">
                        <!-- Data Sources -->
                        <div class="apple-card" style="padding: var(--space-6);">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-4);">
                                <div style="font-size: 14px; font-weight: 600; color: var(--text-primary);">Data Sources</div>
                                <div style="display: flex; align-items: center; gap: var(--space-1);">
                                    <div style="width: 6px; height: 6px; background: var(--apple-green); border-radius: 50%;"></div>
                                    <div style="font-size: 11px; color: var(--apple-green); font-weight: 500;">7 Active</div>
                                </div>
                            </div>

                            <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 16px;">🔗</div>
                                        <div style="font-size: 13px; color: var(--text-primary);">Google Analytics</div>
                                    </div>
                                    <div style="width: 8px; height: 8px; background: var(--apple-green); border-radius: 50%;"></div>
                                </div>

                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 16px;">🔍</div>
                                        <div style="font-size: 13px; color: var(--text-primary);">Search Console</div>
                                    </div>
                                    <div style="width: 8px; height: 8px; background: var(--apple-green); border-radius: 50%;"></div>
                                </div>

                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 16px;">📍</div>
                                        <div style="font-size: 13px; color: var(--text-primary);">Google My Business</div>
                                    </div>
                                    <div style="width: 8px; height: 8px; background: var(--apple-green); border-radius: 50%;"></div>
                                </div>

                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 16px;">📘</div>
                                        <div style="font-size: 13px; color: var(--text-primary);">Facebook Business</div>
                                    </div>
                                    <div style="width: 8px; height: 8px; background: var(--apple-orange); border-radius: 50%;"></div>
                                </div>

                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 16px;">🌟</div>
                                        <div style="font-size: 13px; color: var(--text-primary);">Yelp API</div>
                                    </div>
                                    <div style="width: 8px; height: 8px; background: var(--apple-red); border-radius: 50%;"></div>
                                </div>
                            </div>

                            <button class="apple-btn btn-ghost" style="font-size: 12px; width: 100%; margin-top: var(--space-4);">Manage Connections</button>
                        </div>

                        <!-- AI Platforms -->
                        <div class="apple-card" style="padding: var(--space-6);">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-4);">
                                <div style="font-size: 14px; font-weight: 600; color: var(--text-primary);">AI Platform Intelligence</div>
                                <div style="display: flex; align-items: center; gap: var(--space-1);">
                                    <div style="width: 6px; height: 6px; background: var(--apple-orange); border-radius: 50%;"></div>
                                    <div style="font-size: 11px; color: var(--apple-orange); font-weight: 500;">Live Tracking</div>
                                </div>
                            </div>

                            <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 16px;">🤖</div>
                                        <div style="font-size: 13px; color: var(--text-primary);">ChatGPT</div>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 10px; color: var(--text-secondary);">78 citations</div>
                                        <div style="font-size: 11px; color: var(--apple-green); font-weight: 500;">85 score</div>
                                    </div>
                                </div>

                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 16px;">🔷</div>
                                        <div style="font-size: 13px; color: var(--text-primary);">Google Gemini</div>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 10px; color: var(--text-secondary);">12 citations</div>
                                        <div style="font-size: 11px; color: var(--apple-red); font-weight: 500;">62 score</div>
                                    </div>
                                </div>

                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 16px;">🔍</div>
                                        <div style="font-size: 13px; color: var(--text-primary);">Perplexity AI</div>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 10px; color: var(--text-secondary);">65 citations</div>
                                        <div style="font-size: 11px; color: var(--apple-orange); font-weight: 500;">73 score</div>
                                    </div>
                                </div>

                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 16px;">🪟</div>
                                        <div style="font-size: 13px; color: var(--text-primary);">Microsoft Copilot</div>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 10px; color: var(--text-secondary);">8 citations</div>
                                        <div style="font-size: 11px; color: var(--apple-red); font-weight: 500;">58 score</div>
                                    </div>
                                </div>

                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 16px;">🧠</div>
                                        <div style="font-size: 13px; color: var(--text-primary);">Claude AI</div>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                                        <div style="font-size: 10px; color: var(--text-secondary);">34 citations</div>
                                        <div style="font-size: 11px; color: var(--apple-orange); font-weight: 500;">71 score</div>
                                    </div>
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-2); margin-top: var(--space-4);">
                                <button class="apple-btn btn-ghost" style="font-size: 11px; padding: var(--space-2);">Citation Audit</button>
                                <button class="apple-btn btn-ghost" style="font-size: 11px; padding: var(--space-2);">Optimize Content</button>
                            </div>
                        </div>

                        <!-- System Health -->
                        <div class="apple-card" style="padding: var(--space-6);">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-4);">
                                <div style="font-size: 14px; font-weight: 600; color: var(--text-primary);">System Health</div>
                                <div style="display: flex; align-items: center; gap: var(--space-1);">
                                    <div style="width: 6px; height: 6px; background: var(--apple-green); border-radius: 50%;"></div>
                                    <div style="font-size: 11px; color: var(--apple-green); font-weight: 500;">Operational</div>
                                </div>
                            </div>

                            <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <div style="font-size: 13px; color: var(--text-primary);">API Response Time</div>
                                    <div style="font-size: 11px; color: var(--apple-green); font-weight: 500;">142ms</div>
                                </div>

                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <div style="font-size: 13px; color: var(--text-primary);">Data Sync Status</div>
                                    <div style="font-size: 11px; color: var(--apple-green); font-weight: 500;">Real-time</div>
                                </div>

                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <div style="font-size: 13px; color: var(--text-primary);">Uptime</div>
                                    <div style="font-size: 11px; color: var(--apple-green); font-weight: 500;">99.9%</div>
                                </div>

                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <div style="font-size: 13px; color: var(--text-primary);">Error Rate</div>
                                    <div style="font-size: 11px; color: var(--apple-green); font-weight: 500;">0.1%</div>
                                </div>

                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <div style="font-size: 13px; color: var(--text-primary);">Last Updated</div>
                                    <div style="font-size: 11px; color: var(--text-secondary); font-weight: 500;">2 min ago</div>
                                </div>
                            </div>

                            <button class="apple-btn btn-ghost" style="font-size: 12px; width: 100%; margin-top: var(--space-4);">System Status</button>
                        </div>
                    </div>
                </section>

                <!-- Data Flow & Cross-Platform Insights -->
                <section class="section">
                    <h2 class="section-header">Unified Intelligence</h2>

                    <div class="apple-grid grid-2">
                        <!-- Cross-Platform Insights -->
                        <div class="apple-card" style="padding: var(--space-8);">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-6);">
                                <div>
                                    <div style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-1);">Cross-Platform Insights</div>
                                    <div style="font-size: 13px; color: var(--text-secondary);">Correlated data across ecosystem</div>
                                </div>
                                <div style="font-size: 24px;">🔗</div>
                            </div>

                            <div style="display: flex; flex-direction: column; gap: var(--space-4);">
                                <div style="padding: var(--space-4); background: var(--gray-50); border-radius: var(--radius); border-left: 3px solid var(--apple-blue);">
                                    <div style="font-size: 13px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-1);">Search → Social Correlation</div>
                                    <div style="font-size: 12px; color: var(--text-secondary);">GMB posts drive 23% increase in organic CTR</div>
                                </div>

                                <div style="padding: var(--space-4); background: var(--gray-50); border-radius: var(--radius); border-left: 3px solid var(--apple-green);">
                                    <div style="font-size: 13px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-1);">Review → AI Citation Link</div>
                                    <div style="font-size: 12px; color: var(--text-secondary);">Recent 5-star reviews improve ChatGPT responses</div>
                                </div>

                                <div style="padding: var(--space-4); background: var(--gray-50); border-radius: var(--radius); border-left: 3px solid var(--apple-orange);">
                                    <div style="font-size: 13px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-1);">Technical → Visibility Impact</div>
                                    <div style="font-size: 12px; color: var(--text-secondary);">Schema fixes increased AEO score by 12%</div>
                                </div>
                            </div>
                        </div>

                        <!-- Ecosystem Command Center -->
                        <div class="apple-card" style="padding: var(--space-8);">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-6);">
                                <div>
                                    <div style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-1);">Command Center</div>
                                    <div style="font-size: 13px; color: var(--text-secondary);">Direct ecosystem control</div>
                                </div>
                                <div style="font-size: 24px;">🎛️</div>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-3);">
                                <button class="apple-btn btn-secondary" style="font-size: 12px; padding: var(--space-3); flex-direction: column; gap: var(--space-1);">
                                    <div style="font-size: 16px;">📊</div>
                                    <div>Sync All Data</div>
                                </button>

                                <button class="apple-btn btn-secondary" style="font-size: 12px; padding: var(--space-3); flex-direction: column; gap: var(--space-1);">
                                    <div style="font-size: 16px;">🔄</div>
                                    <div>Refresh APIs</div>
                                </button>

                                <button class="apple-btn btn-secondary" style="font-size: 12px; padding: var(--space-3); flex-direction: column; gap: var(--space-1);">
                                    <div style="font-size: 16px;">📈</div>
                                    <div>Export Unified</div>
                                </button>

                                <button class="apple-btn btn-secondary" style="font-size: 12px; padding: var(--space-3); flex-direction: column; gap: var(--space-1);">
                                    <div style="font-size: 16px;">⚙️</div>
                                    <div>Configure</div>
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Intelligence Feed Section -->
                <section class="section">
                    <div class="live-feed">
                        <div class="feed-header">
                            <div>
                                <div class="feed-title">Live Intelligence</div>
                                <div class="feed-subtitle">Cross-platform monitoring updates</div>
                            </div>
                        </div>
                        <div class="feed-content">
                            <div class="feed-item success">
                                <div class="feed-text">ChatGPT citations increased 23% following executive strategy deployment</div>
                                <div class="feed-time">2 min ago</div>
                            </div>
                            <div class="feed-item warning">
                                <div class="feed-text">Competitor Terry Reid Hyundai launched new AI optimization campaign</div>
                                <div class="feed-time">8 min ago</div>
                            </div>
                            <div class="feed-item success">
                                <div class="feed-text">Bulk schema updates completed across 12 pages - AI scores improving</div>
                                <div class="feed-time">15 min ago</div>
                            </div>
                            <div class="feed-item">
                                <div class="feed-text">Electric vehicle market opportunity score increased to 94</div>
                                <div class="feed-time">23 min ago</div>
                            </div>
                            <div class="feed-item success">
                                <div class="feed-text">ROI attribution model updated - AI citations now worth $890K annually</div>
                                <div class="feed-time">31 min ago</div>
                            </div>
                            <div class="feed-item error">
                                <div class="feed-text">Yelp API connection restored - emergency protocols successful</div>
                                <div class="feed-time">45 min ago</div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Action Buttons -->
                <div style="display: flex; gap: var(--space-3); justify-content: center; margin-top: var(--space-12); flex-wrap: wrap;">
                    <button class="apple-btn btn-primary" onclick="launchExecutiveAnalysis()">🚀 Launch Executive Analysis</button>
                    <button class="apple-btn btn-secondary" onclick="generateCSuiteReport()">📊 Generate C-Suite Report</button>
                    <button class="apple-btn btn-secondary" onclick="executeBulkActions()">⚡ Execute Bulk Actions</button>
                    <button class="apple-btn btn-secondary" onclick="optimizeAICitations()">🤖 Optimize AI Citations</button>
                    <button class="apple-btn btn-secondary" onclick="syncEcosystem()">🔄 Sync Ecosystem</button>
                </div>
            </div>

            <!-- AI Health Tab -->
            <div id="ai-health" class="tab-content">
                <section class="section">
                    <h1 class="section-header">AI Health Dashboard</h1>
                    <p class="section-subheader">Comprehensive analysis of search optimization performance</p>

                    <div style="text-align: center; padding: var(--space-16); color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: var(--space-4);">🤖</div>
                        <div style="font-size: 18px; font-weight: 500;">AI Health analysis will be available here</div>
                        <div style="font-size: 14px; margin-top: var(--space-2);">Comprehensive metrics and recommendations coming soon</div>
                    </div>
                </section>
            </div>

            <!-- Website Performance Tab -->
            <div id="website" class="tab-content">
                <section class="section">
                    <h1 class="section-header">Website Performance</h1>

                    <!-- Error Detection Section -->
                    <div class="apple-card" style="margin-bottom: var(--space-6);">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-6);">
                            <div>
                                <h2 style="font-size: 20px; font-weight: 600; margin-bottom: var(--space-2);">🚨 Error Detection & Monitoring</h2>
                                <p style="color: var(--text-secondary); font-size: 14px;">Real-time monitoring of HTTP errors across your website</p>
                            </div>
                            <button onclick="scanForErrors()" class="apple-btn btn-primary">🔍 Scan Now</button>
                        </div>

                        <!-- Error Stats Grid -->
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--space-4); margin-bottom: var(--space-6);">
                            <div class="apple-card" style="text-align: center; padding: var(--space-4);">
                                <div style="font-size: 32px; font-weight: 700; color: var(--apple-red); margin-bottom: var(--space-2);" id="error-4xx-count">0</div>
                                <div style="font-size: 13px; color: var(--text-secondary);">4xx Errors</div>
                            </div>
                            <div class="apple-card" style="text-align: center; padding: var(--space-4);">
                                <div style="font-size: 32px; font-weight: 700; color: var(--apple-orange); margin-bottom: var(--space-2);" id="error-5xx-count">0</div>
                                <div style="font-size: 13px; color: var(--text-secondary);">5xx Errors</div>
                            </div>
                            <div class="apple-card" style="text-align: center; padding: var(--space-4);">
                                <div style="font-size: 32px; font-weight: 700; color: var(--apple-green); margin-bottom: var(--space-2);" id="pages-scanned">0</div>
                                <div style="font-size: 13px; color: var(--text-secondary);">Pages Scanned</div>
                            </div>
                            <div class="apple-card" style="text-align: center; padding: var(--space-4);">
                                <div style="font-size: 32px; font-weight: 700; color: var(--apple-blue); margin-bottom: var(--space-2);" id="uptime-percentage">99.9%</div>
                                <div style="font-size: 13px; color: var(--text-secondary);">Uptime (30d)</div>
                            </div>
                        </div>

                        <!-- Recent Errors List -->
                        <div id="errors-list" style="display: none;">
                            <h3 style="font-size: 16px; font-weight: 600; margin-bottom: var(--space-4);">Recent Errors</h3>
                            <div id="errors-container"></div>
                        </div>

                        <div id="no-errors" style="text-align: center; padding: var(--space-8); color: var(--text-secondary); display: none;">
                            <div style="font-size: 48px; margin-bottom: var(--space-3);">✅</div>
                            <div style="font-size: 16px; font-weight: 500;">No errors detected</div>
                            <div style="font-size: 13px; margin-top: var(--space-2);">Your website is running smoothly!</div>
                        </div>
                    </div>

                    <!-- Core Web Vitals -->
                    <div class="apple-card" style="margin-bottom: var(--space-6);">
                        <h2 style="font-size: 20px; font-weight: 600; margin-bottom: var(--space-6);">⚡ Core Web Vitals</h2>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-6);">
                            <!-- LCP -->
                            <div>
                                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-3);">
                                    <span style="font-weight: 500;">Largest Contentful Paint</span>
                                    <span data-metric="lcp" style="font-size: 20px; font-weight: 700; color: var(--apple-green);">Loading...</span>
                                </div>
                                <div style="height: 8px; background: var(--gray-200); border-radius: 4px; overflow: hidden;">
                                    <div data-progress="lcp" style="width: 0%; height: 100%; background: var(--apple-green); transition: width 0.5s ease;"></div>
                                </div>
                                <div style="font-size: 12px; color: var(--text-secondary); margin-top: var(--space-2);">Target: <2.5s • Status: <span data-status="lcp">Measuring...</span></div>
                            </div>
                            <!-- FID -->
                            <div>
                                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-3);">
                                    <span style="font-weight: 500;">First Input Delay</span>
                                    <span data-metric="fid" style="font-size: 20px; font-weight: 700; color: var(--apple-green);">Loading...</span>
                                </div>
                                <div style="height: 8px; background: var(--gray-200); border-radius: 4px; overflow: hidden;">
                                    <div data-progress="fid" style="width: 0%; height: 100%; background: var(--apple-green); transition: width 0.5s ease;"></div>
                                </div>
                                <div style="font-size: 12px; color: var(--text-secondary); margin-top: var(--space-2);">Target: <100ms • Status: <span data-status="fid">Measuring...</span></div>
                            </div>
                            <!-- CLS -->
                            <div>
                                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-3);">
                                    <span style="font-weight: 500;">Cumulative Layout Shift</span>
                                    <span data-metric="cls" style="font-size: 20px; font-weight: 700; color: var(--apple-green);">Loading...</span>
                                </div>
                                <div style="height: 8px; background: var(--gray-200); border-radius: 4px; overflow: hidden;">
                                    <div data-progress="cls" style="width: 0%; height: 100%; background: var(--apple-green); transition: width 0.5s ease;"></div>
                                </div>
                                <div style="font-size: 12px; color: var(--text-secondary); margin-top: var(--space-2);">Target: <0.1 • Status: <span data-status="cls">Measuring...</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- Page Speed Insights -->
                    <div class="apple-grid grid-2" style="margin-bottom: var(--space-6);">
                        <div class="apple-card">
                            <h3 style="font-size: 18px; font-weight: 600; margin-bottom: var(--space-4);">📱 Mobile Performance</h3>
                            <div style="display: flex; align-items: center; justify-content: center; margin-bottom: var(--space-4);">
                                <div style="position: relative; width: 120px; height: 120px;">
                                    <svg viewBox="0 0 120 120" style="transform: rotate(-90deg);">
                                        <circle cx="60" cy="60" r="54" fill="none" stroke="var(--gray-200)" stroke-width="12"></circle>
                                        <circle cx="60" cy="60" r="54" fill="none" stroke="var(--apple-green)" stroke-width="12" stroke-dasharray="339.292" stroke-dashoffset="67.858"></circle>
                                    </svg>
                                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;">
                                        <div style="font-size: 28px; font-weight: 700;">89</div>
                                        <div style="font-size: 11px; color: var(--text-secondary);">Score</div>
                                    </div>
                                </div>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: var(--space-2); font-size: 13px;">
                                <div style="display: flex; justify-content: space-between;"><span>Speed Index</span><span style="font-weight: 600;">1.8s</span></div>
                                <div style="display: flex; justify-content: space-between;"><span>Time to Interactive</span><span style="font-weight: 600;">2.1s</span></div>
                                <div style="display: flex; justify-content: space-between;"><span>Total Blocking Time</span><span style="font-weight: 600;">120ms</span></div>
                            </div>
                        </div>

                        <div class="apple-card">
                            <h3 style="font-size: 18px; font-weight: 600; margin-bottom: var(--space-4);">💻 Desktop Performance</h3>
                            <div style="display: flex; align-items: center; justify-content: center; margin-bottom: var(--space-4);">
                                <div style="position: relative; width: 120px; height: 120px;">
                                    <svg viewBox="0 0 120 120" style="transform: rotate(-90deg);">
                                        <circle cx="60" cy="60" r="54" fill="none" stroke="var(--gray-200)" stroke-width="12"></circle>
                                        <circle cx="60" cy="60" r="54" fill="none" stroke="var(--apple-green)" stroke-width="12" stroke-dasharray="339.292" stroke-dashoffset="33.929"></circle>
                                    </svg>
                                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;">
                                        <div style="font-size: 28px; font-weight: 700;">96</div>
                                        <div style="font-size: 11px; color: var(--text-secondary);">Score</div>
                                    </div>
                                </div>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: var(--space-2); font-size: 13px;">
                                <div style="display: flex; justify-content: space-between;"><span>Speed Index</span><span style="font-weight: 600;">0.9s</span></div>
                                <div style="display: flex; justify-content: space-between;"><span>Time to Interactive</span><span style="font-weight: 600;">1.2s</span></div>
                                <div style="display: flex; justify-content: space-between;"><span>Total Blocking Time</span><span style="font-weight: 600;">45ms</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- Security & SSL -->
                    <div class="apple-card" style="margin-bottom: var(--space-6);">
                        <h2 style="font-size: 20px; font-weight: 600; margin-bottom: var(--space-6);">🔒 Security & SSL</h2>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-4);">
                            <div style="padding: var(--space-4); background: var(--gray-50); border-radius: var(--radius);">
                                <div style="display: flex; align-items: center; gap: var(--space-2); margin-bottom: var(--space-2);">
                                    <span style="font-size: 20px;">✅</span>
                                    <span style="font-weight: 600;">SSL Certificate</span>
                                </div>
                                <div style="font-size: 13px; color: var(--text-secondary);">Valid until: Dec 2025</div>
                            </div>
                            <div style="padding: var(--space-4); background: var(--gray-50); border-radius: var(--radius);">
                                <div style="display: flex; align-items: center; gap: var(--space-2); margin-bottom: var(--space-2);">
                                    <span style="font-size: 20px;">✅</span>
                                    <span style="font-weight: 600;">HTTPS Redirect</span>
                                </div>
                                <div style="font-size: 13px; color: var(--text-secondary);">All traffic secured</div>
                            </div>
                            <div style="padding: var(--space-4); background: var(--gray-50); border-radius: var(--radius);">
                                <div style="display: flex; align-items: center; gap: var(--space-2); margin-bottom: var(--space-2);">
                                    <span style="font-size: 20px;">✅</span>
                                    <span style="font-weight: 600;">Security Headers</span>
                                </div>
                                <div style="font-size: 13px; color: var(--text-secondary);">A+ Rating</div>
                            </div>
                        </div>
                    </div>

                    <!-- Recommendations -->
                    <div class="apple-card">
                        <h2 style="font-size: 20px; font-weight: 600; margin-bottom: var(--space-6);">💡 Optimization Recommendations</h2>
                        <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                            <div style="display: flex; align-items: start; gap: var(--space-3); padding: var(--space-4); background: rgba(52, 199, 89, 0.1); border-radius: var(--radius); border-left: 4px solid var(--apple-green);">
                                <span style="font-size: 24px;">✅</span>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; margin-bottom: var(--space-1);">Image Optimization</div>
                                    <div style="font-size: 13px; color: var(--text-secondary);">All images are properly compressed and using modern formats (WebP)</div>
                                </div>
                            </div>
                            <div style="display: flex; align-items: start; gap: var(--space-3); padding: var(--space-4); background: rgba(255, 149, 0, 0.1); border-radius: var(--radius); border-left: 4px solid var(--apple-orange);">
                                <span style="font-size: 24px;">⚠️</span>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; margin-bottom: var(--space-1);">Enable Browser Caching</div>
                                    <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: var(--space-2);">Set longer cache times for static assets (2 pages affected)</div>
                                    <button onclick="showRecommendationDetails('caching')" class="apple-btn btn-ghost" style="font-size: 12px; padding: var(--space-2) var(--space-3);">View Details</button>
                                </div>
                            </div>
                            <div style="display: flex; align-items: start; gap: var(--space-3); padding: var(--space-4); background: rgba(0, 122, 255, 0.1); border-radius: var(--radius); border-left: 4px solid var(--apple-blue);">
                                <span style="font-size: 24px;">💡</span>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; margin-bottom: var(--space-1);">Implement Lazy Loading</div>
                                    <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: var(--space-2);">Defer off-screen images to improve initial page load (Est. +0.3s improvement)</div>
                                    <button onclick="showRecommendationDetails('lazy')" class="apple-btn btn-ghost" style="font-size: 12px; padding: var(--space-2) var(--space-3);">View Details</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <div id="schema" class="tab-content">
                <section class="section">
                    <h1 class="section-header">Schema Optimization</h1>
                    <div style="text-align: center; padding: var(--space-16); color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: var(--space-4);">🔍</div>
                        <div style="font-size: 18px; font-weight: 500;">Schema audit coming soon</div>
                    </div>
                </section>
            </div>

            <div id="reviews" class="tab-content">
                <section class="section">
                    <h1 class="section-header">Review Management</h1>
                    <div style="text-align: center; padding: var(--space-16); color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: var(--space-4);">⭐</div>
                        <div style="font-size: 18px; font-weight: 500;">Review analysis coming soon</div>
                    </div>
                </section>
            </div>

            <div id="mystery-shop" class="tab-content">
                <section class="section">
                    <h1 class="section-header">Mystery Shopping</h1>
                    <div style="text-align: center; padding: var(--space-16); color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: var(--space-4);">🕵️</div>
                        <div style="font-size: 18px; font-weight: 500;">Mystery shop reports coming soon</div>
                    </div>
                </section>
            </div>

            <div id="predictive" class="tab-content">
                <section class="section">
                    <h1 class="section-header">Predictive Analytics</h1>
                    <div style="text-align: center; padding: var(--space-16); color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: var(--space-4);">🔮</div>
                        <div style="font-size: 18px; font-weight: 500;">Predictive insights coming soon</div>
                    </div>
                </section>
            </div>

            <div id="geo-sge" class="tab-content">
                <section class="section">
                    <h1 class="section-header">GEO/SGE Analysis</h1>
                    <div style="text-align: center; padding: var(--space-16); color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: var(--space-4);">🌍</div>
                        <div style="font-size: 18px; font-weight: 500;">GEO/SGE analysis coming soon</div>
                    </div>
                </section>
            </div>

            <div id="settings" class="tab-content">
                <!-- API Configuration Section -->
                <section class="section">
                    <h1 class="section-header">API Configuration</h1>
                    <p class="section-subheader">Manage your API keys and external service connections</p>

                    <div class="apple-grid grid-2">
                        <!-- Google APIs -->
                        <div class="apple-card" style="padding: var(--space-8);">
                            <div style="display: flex; align-items: center; margin-bottom: var(--space-6);">
                                <div style="font-size: 24px; margin-right: var(--space-3);">🔍</div>
                                <div>
                                    <h3 style="font-size: 18px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-1);">Google Services</h3>
                                    <div style="font-size: 13px; color: var(--text-secondary);">Analytics, Search Console, My Business</div>
                                </div>
                            </div>

                            <div style="space-y: var(--space-4);">
                                <div class="api-key-field">
                                    <label style="display: block; font-size: 14px; font-weight: 500; color: var(--text-primary); margin-bottom: var(--space-2);">Google Analytics API Key</label>
                                    <div style="display: flex; gap: var(--space-2);">
                                        <input type="password" id="ga-api-key" placeholder="Enter Google Analytics API Key" style="flex: 1; padding: var(--space-3); border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 14px;">
                                        <button onclick="toggleApiKeyVisibility('ga-api-key')" style="padding: var(--space-3); border: 1px solid var(--gray-300); border-radius: var(--radius-sm); background: white; cursor: pointer;">👁️</button>
                                    </div>
                                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: var(--space-1);">Required for traffic and conversion tracking</div>
                                </div>

                                <div class="api-key-field" style="margin-top: var(--space-4);">
                                    <label style="display: block; font-size: 14px; font-weight: 500; color: var(--text-primary); margin-bottom: var(--space-2);">Search Console API Key</label>
                                    <div style="display: flex; gap: var(--space-2);">
                                        <input type="password" id="gsc-api-key" placeholder="Enter Search Console API Key" style="flex: 1; padding: var(--space-3); border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 14px;">
                                        <button onclick="toggleApiKeyVisibility('gsc-api-key')" style="padding: var(--space-3); border: 1px solid var(--gray-300); border-radius: var(--radius-sm); background: white; cursor: pointer;">👁️</button>
                                    </div>
                                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: var(--space-1);">Required for search performance data</div>
                                </div>

                                <div class="api-key-field" style="margin-top: var(--space-4);">
                                    <label style="display: block; font-size: 14px; font-weight: 500; color: var(--text-primary); margin-bottom: var(--space-2);">My Business API Key</label>
                                    <div style="display: flex; gap: var(--space-2);">
                                        <input type="password" id="gmb-api-key" placeholder="Enter My Business API Key" style="flex: 1; padding: var(--space-3); border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 14px;">
                                        <button onclick="toggleApiKeyVisibility('gmb-api-key')" style="padding: var(--space-3); border: 1px solid var(--gray-300); border-radius: var(--radius-sm); background: white; cursor: pointer;">👁️</button>
                                    </div>
                                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: var(--space-1);">Required for local business insights</div>
                                </div>

                                <button onclick="testGoogleApis()" class="apple-btn btn-secondary" style="width: 100%; margin-top: var(--space-4);">🧪 Test Google API Connections</button>
                            </div>
                        </div>

                        <!-- Social Media APIs -->
                        <div class="apple-card" style="padding: var(--space-8);">
                            <div style="display: flex; align-items: center; margin-bottom: var(--space-6);">
                                <div style="font-size: 24px; margin-right: var(--space-3);">📱</div>
                                <div>
                                    <h3 style="font-size: 18px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-1);">Social Media</h3>
                                    <div style="font-size: 13px; color: var(--text-secondary);">Facebook, Yelp, Review Platforms</div>
                                </div>
                            </div>

                            <div style="space-y: var(--space-4);">
                                <div class="api-key-field">
                                    <label style="display: block; font-size: 14px; font-weight: 500; color: var(--text-primary); margin-bottom: var(--space-2);">Facebook Access Token</label>
                                    <div style="display: flex; gap: var(--space-2);">
                                        <input type="password" id="fb-access-token" placeholder="Enter Facebook Access Token" style="flex: 1; padding: var(--space-3); border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 14px;">
                                        <button onclick="toggleApiKeyVisibility('fb-access-token')" style="padding: var(--space-3); border: 1px solid var(--gray-300); border-radius: var(--radius-sm); background: white; cursor: pointer;">👁️</button>
                                    </div>
                                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: var(--space-1);">Required for Facebook Business metrics</div>
                                </div>

                                <div class="api-key-field" style="margin-top: var(--space-4);">
                                    <label style="display: block; font-size: 14px; font-weight: 500; color: var(--text-primary); margin-bottom: var(--space-2);">Yelp API Key</label>
                                    <div style="display: flex; gap: var(--space-2);">
                                        <input type="password" id="yelp-api-key" placeholder="Enter Yelp API Key" style="flex: 1; padding: var(--space-3); border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 14px;">
                                        <button onclick="toggleApiKeyVisibility('yelp-api-key')" style="padding: var(--space-3); border: 1px solid var(--gray-300); border-radius: var(--radius-sm); background: white; cursor: pointer;">👁️</button>
                                    </div>
                                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: var(--space-1);">Required for review and rating data</div>
                                </div>

                                <button onclick="testSocialApis()" class="apple-btn btn-secondary" style="width: 100%; margin-top: var(--space-4);">🧪 Test Social Media APIs</button>
                            </div>
                        </div>
                    </div>

                    <!-- Save Configuration -->
                    <div style="text-align: center; margin-top: var(--space-8);">
                        <button onclick="saveApiKeys()" class="apple-btn btn-primary" style="margin-right: var(--space-3);">💾 Save API Configuration</button>
                        <button onclick="loadApiKeys()" class="apple-btn btn-secondary">🔄 Load Current Keys</button>
                    </div>
                </section>

                <!-- Connection Status Section -->
                <section class="section">
                    <h2 class="section-header">Connection Status</h2>
                    <p class="section-subheader">Real-time status of all API connections</p>

                    <div class="apple-grid grid-3">
                        <div class="apple-card" style="padding: var(--space-6);">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-4);">
                                <div>
                                    <div style="font-weight: 600; color: var(--text-primary);">Google Services</div>
                                    <div style="font-size: 13px; color: var(--text-secondary);">3 APIs</div>
                                </div>
                                <div id="google-status" class="status-indicator" style="width: 12px; height: 12px; border-radius: 50%; background: var(--gray-400);"></div>
                            </div>
                            <div style="font-size: 12px; color: var(--text-secondary);" id="google-status-text">Not configured</div>
                        </div>

                        <div class="apple-card" style="padding: var(--space-6);">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-4);">
                                <div>
                                    <div style="font-weight: 600; color: var(--text-primary);">Social Media</div>
                                    <div style="font-size: 13px; color: var(--text-secondary);">2 APIs</div>
                                </div>
                                <div id="social-status" class="status-indicator" style="width: 12px; height: 12px; border-radius: 50%; background: var(--gray-400);"></div>
                            </div>
                            <div style="font-size: 12px; color: var(--text-secondary);" id="social-status-text">Not configured</div>
                        </div>

                        <div class="apple-card" style="padding: var(--space-6);">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-4);">
                                <div>
                                    <div style="font-weight: 600; color: var(--text-primary);">Database</div>
                                    <div style="font-size: 13px; color: var(--text-secondary);">Supabase</div>
                                </div>
                                <div id="database-status" class="status-indicator" style="width: 12px; height: 12px; border-radius: 50%; background: var(--apple-green);"></div>
                            </div>
                            <div style="font-size: 12px; color: var(--text-secondary);" id="database-status-text">Connected</div>
                        </div>
                    </div>
                </section>

                <!-- API Usage Analytics -->
                <section class="section">
                    <h2 class="section-header">API Usage Analytics</h2>
                    <div class="apple-grid grid-4">
                        <div class="apple-card metric-card">
                            <div class="metric-header">
                                <div class="metric-icon" style="background: rgba(0, 122, 255, 0.1); color: var(--apple-blue);">📊</div>
                                <div class="metric-badge">Today</div>
                            </div>
                            <div class="metric-label">API Calls</div>
                            <div class="metric-value" id="api-calls-today">0</div>
                            <div class="metric-change">Quota remaining: <span id="quota-remaining">100%</span></div>
                        </div>

                        <div class="apple-card metric-card">
                            <div class="metric-header">
                                <div class="metric-icon" style="background: rgba(52, 199, 89, 0.1); color: var(--apple-green);">✅</div>
                                <div class="metric-badge">24h</div>
                            </div>
                            <div class="metric-label">Success Rate</div>
                            <div class="metric-value" id="success-rate">0%</div>
                            <div class="metric-change">All API connections</div>
                        </div>

                        <div class="apple-card metric-card">
                            <div class="metric-header">
                                <div class="metric-icon" style="background: rgba(255, 149, 0, 0.1); color: var(--apple-orange);">⏱️</div>
                                <div class="metric-badge">Live</div>
                            </div>
                            <div class="metric-label">Response Time</div>
                            <div class="metric-value" id="response-time">0ms</div>
                            <div class="metric-change">Average latency</div>
                        </div>

                        <div class="apple-card metric-card">
                            <div class="metric-header">
                                <div class="metric-icon" style="background: rgba(255, 59, 48, 0.1); color: var(--apple-red);">❌</div>
                                <div class="metric-badge">Errors</div>
                            </div>
                            <div class="metric-label">Failed Requests</div>
                            <div class="metric-value" id="failed-requests">0</div>
                            <div class="metric-change">Last 24 hours</div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- SEO Modal -->
    <div id="seo-modal" class="cupertino-modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title">🔍 Traditional SEO Visibility Analysis</div>
                <button class="modal-close" onclick="closeModal('seo-modal')">×</button>
            </div>
            <div class="modal-body">
                <div class="health-score">
                    <div class="health-value">87.3</div>
                    <div class="health-label">SEO Visibility Score</div>
                    <div class="health-progress">
                        <div class="health-bar" style="width: 87.3%"></div>
                    </div>
                </div>
                <p style="color: var(--text-secondary); text-align: center; margin-bottom: var(--space-8);">
                    Your SEO visibility score indicates <strong style="color: var(--apple-blue);">strong performance</strong> across traditional search metrics with room for improvement in specific areas.
                </p>

                <!-- Formula Breakdown -->
                <div style="background: var(--gray-50); padding: var(--space-6); border-radius: var(--radius); margin-bottom: var(--space-6);">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: var(--space-4); color: var(--text-primary);">Score Breakdown</h3>
                    <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 14px;">Brand Mentions (20%)</span>
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <div style="width: 120px; height: 6px; background: var(--gray-200); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 92%; height: 100%; background: var(--apple-green);"></div>
                                </div>
                                <span style="font-weight: 600; font-size: 14px; min-width: 40px;">92/100</span>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 14px;">Citations (25%)</span>
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <div style="width: 120px; height: 6px; background: var(--gray-200); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 88%; height: 100%; background: var(--apple-green);"></div>
                                </div>
                                <span style="font-weight: 600; font-size: 14px; min-width: 40px;">88/100</span>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 14px;">Sentiment Score (15%)</span>
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <div style="width: 120px; height: 6px; background: var(--gray-200); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 85%; height: 100%; background: var(--apple-blue);"></div>
                                </div>
                                <span style="font-weight: 600; font-size: 14px; min-width: 40px;">85/100</span>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 14px;">Content Quality (25%)</span>
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <div style="width: 120px; height: 6px; background: var(--gray-200); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 81%; height: 100%; background: var(--apple-orange);"></div>
                                </div>
                                <span style="font-weight: 600; font-size: 14px; min-width: 40px;">81/100</span>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 14px;">Share of Voice (15%)</span>
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <div style="width: 120px; height: 6px; background: var(--gray-200); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 89%; height: 100%; background: var(--apple-green);"></div>
                                </div>
                                <span style="font-weight: 600; font-size: 14px; min-width: 40px;">89/100</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Competitive Benchmarking -->
                <div style="background: linear-gradient(135deg, rgba(0, 122, 255, 0.05), transparent); padding: var(--space-6); border-radius: var(--radius); margin-bottom: var(--space-6); border: 1px solid rgba(0, 122, 255, 0.1);">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: var(--space-4); color: var(--text-primary);">📊 Competitive Benchmarking</h3>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-4); margin-bottom: var(--space-4);">
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: var(--apple-green); margin-bottom: var(--space-1);">87.3</div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--space-1);">Your Score</div>
                            <div style="font-size: 11px; color: var(--apple-green);">🏆 Top 15%</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: var(--text-secondary); margin-bottom: var(--space-1);">76.4</div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--space-1);">Industry Avg</div>
                            <div style="font-size: 11px; color: var(--text-secondary);">📊 Baseline</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: var(--apple-blue); margin-bottom: var(--space-1);">94.2</div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--space-1);">Top Performer</div>
                            <div style="font-size: 11px; color: var(--apple-blue);">⭐ Goal</div>
                        </div>
                    </div>
                    <div style="font-size: 13px; color: var(--text-secondary); text-align: center;">
                        You're <strong style="color: var(--apple-green);">+10.9 points above average</strong> • <strong style="color: var(--apple-blue);">6.9 points from top tier</strong>
                    </div>
                </div>

                <!-- AI-Powered Recommendations with ROI -->
                <div style="margin-bottom: var(--space-6);">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-4);">
                        <h3 style="font-size: 16px; font-weight: 600; color: var(--text-primary);">🤖 AI-Powered Action Plan</h3>
                        <div style="font-size: 11px; color: var(--text-secondary); background: var(--gray-100); padding: var(--space-1) var(--space-2); border-radius: var(--radius-sm);">Sorted by Impact</div>
                    </div>

                    <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                        <!-- Action 1 -->
                        <div style="border: 2px solid var(--apple-blue); border-radius: var(--radius); overflow: hidden;">
                            <button class="apple-btn btn-primary" onclick="handleSeoAction('content')" style="justify-content: space-between; border-radius: 0; border-bottom: 1px solid rgba(255,255,255,0.2);">
                                <span>📝 Optimize Content Quality</span>
                                <span style="font-size: 12px; opacity: 0.8;">+6 pts</span>
                            </button>
                            <div style="padding: var(--space-4); background: linear-gradient(135deg, rgba(0, 122, 255, 0.05), transparent);">
                                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--space-3); margin-bottom: var(--space-3);">
                                    <div><div style="font-size: 11px; color: var(--text-secondary); margin-bottom: var(--space-1);">Priority</div><div style="font-size: 13px; font-weight: 600; color: var(--apple-orange);">🔥 Medium</div></div>
                                    <div><div style="font-size: 11px; color: var(--text-secondary); margin-bottom: var(--space-1);">Est. ROI</div><div style="font-size: 13px; font-weight: 600; color: var(--apple-green);">$12,400</div></div>
                                    <div><div style="font-size: 11px; color: var(--text-secondary); margin-bottom: var(--space-1);">Timeline</div><div style="font-size: 13px; font-weight: 600;">2-3 weeks</div></div>
                                    <div><div style="font-size: 11px; color: var(--text-secondary); margin-bottom: var(--space-1);">Effort</div><div style="font-size: 13px; font-weight: 600;">⚡⚡○</div></div>
                                </div>
                                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--space-3);"><strong>Impact:</strong> +320 monthly visitors • +5.8% conversion</div>
                                <div style="display: flex; gap: var(--space-2);"><button onclick="showPreview('seo', 'content')" class="apple-btn btn-ghost" style="font-size: 12px; padding: var(--space-2) var(--space-3);">👁️ Preview</button><button onclick="showDependencies('seo', 'content')" class="apple-btn btn-ghost" style="font-size: 12px; padding: var(--space-2) var(--space-3);">🔗 Dependencies</button></div>
                            </div>
                        </div>

                        <!-- Action 2 -->
                        <div style="border: 1px solid var(--gray-300); border-radius: var(--radius); overflow: hidden;">
                            <button class="apple-btn btn-secondary" onclick="handleSeoAction('citations')" style="justify-content: space-between; border-radius: 0; border-bottom: 1px solid var(--gray-200);">
                                <span>🔗 Build More Citations</span>
                                <span style="font-size: 12px; opacity: 0.8;">+4 pts</span>
                            </button>
                            <div style="padding: var(--space-4); background: var(--gray-50);">
                                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--space-3); margin-bottom: var(--space-3);">
                                    <div><div style="font-size: 11px; color: var(--text-secondary); margin-bottom: var(--space-1);">Priority</div><div style="font-size: 13px; font-weight: 600;">📊 Low</div></div>
                                    <div><div style="font-size: 11px; color: var(--text-secondary); margin-bottom: var(--space-1);">Est. ROI</div><div style="font-size: 13px; font-weight: 600; color: var(--apple-green);">$8,700</div></div>
                                    <div><div style="font-size: 11px; color: var(--text-secondary); margin-bottom: var(--space-1);">Timeline</div><div style="font-size: 13px; font-weight: 600;">4-6 weeks</div></div>
                                    <div><div style="font-size: 11px; color: var(--text-secondary); margin-bottom: var(--space-1);">Effort</div><div style="font-size: 13px; font-weight: 600;">⚡⚡⚡</div></div>
                                </div>
                                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--space-3);"><strong>Impact:</strong> +220 monthly visitors • +3.2% domain authority</div>
                                <div style="display: flex; gap: var(--space-2);"><button onclick="showPreview('seo', 'citations')" class="apple-btn btn-ghost" style="font-size: 12px; padding: var(--space-2) var(--space-3);">👁️ Preview</button><button onclick="showDependencies('seo', 'citations')" class="apple-btn btn-ghost" style="font-size: 12px; padding: var(--space-2) var(--space-3);">🔗 Dependencies</button></div>
                            </div>
                        </div>

                        <!-- Action 3 -->
                        <div style="border: 1px solid var(--gray-300); border-radius: var(--radius); overflow: hidden;">
                            <button class="apple-btn btn-secondary" onclick="handleSeoAction('technical')" style="justify-content: space-between; border-radius: 0; border-bottom: 1px solid var(--gray-200);">
                                <span>⚙️ Technical SEO Audit</span>
                                <span style="font-size: 12px; opacity: 0.8;">+3 pts</span>
                            </button>
                            <div style="padding: var(--space-4); background: var(--gray-50);">
                                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--space-3); margin-bottom: var(--space-3);">
                                    <div><div style="font-size: 11px; color: var(--text-secondary); margin-bottom: var(--space-1);">Priority</div><div style="font-size: 13px; font-weight: 600;">📊 Low</div></div>
                                    <div><div style="font-size: 11px; color: var(--text-secondary); margin-bottom: var(--space-1);">Est. ROI</div><div style="font-size: 13px; font-weight: 600; color: var(--apple-green);">$5,300</div></div>
                                    <div><div style="font-size: 11px; color: var(--text-secondary); margin-bottom: var(--space-1);">Timeline</div><div style="font-size: 13px; font-weight: 600;">1-2 weeks</div></div>
                                    <div><div style="font-size: 11px; color: var(--text-secondary); margin-bottom: var(--space-1);">Effort</div><div style="font-size: 13px; font-weight: 600;">⚡○○</div></div>
                                </div>
                                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--space-3);"><strong>Impact:</strong> +150 monthly visitors • Faster load</div>
                                <div style="display: flex; gap: var(--space-2);"><button onclick="showPreview('seo', 'technical')" class="apple-btn btn-ghost" style="font-size: 12px; padding: var(--space-2) var(--space-3);">👁️ Preview</button><button onclick="showDependencies('seo', 'technical')" class="apple-btn btn-ghost" style="font-size: 12px; padding: var(--space-2) var(--space-3);">🔗 Dependencies</button></div>
                            </div>
                        </div>
                    </div>

                    <!-- Total Impact -->
                    <div style="margin-top: var(--space-4); padding: var(--space-4); background: linear-gradient(135deg, rgba(52, 199, 89, 0.1), transparent); border-radius: var(--radius); border-left: 4px solid var(--apple-green);">
                        <div style="font-size: 14px; font-weight: 600; margin-bottom: var(--space-2);">💰 Combined Impact (All Actions)</div>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-3); font-size: 13px;"><div><strong>Total ROI:</strong> <span style="color: var(--apple-green);">$26,400</span></div><div><strong>Timeline:</strong> 2-6 weeks</div><div><strong>New Visitors:</strong> +690/month</div></div>
                    </div>
                </div>

                <div style="display: flex; gap: var(--space-3); justify-content: center; flex-wrap: wrap;">
                    <button class="apple-btn btn-primary" onclick="exportAnalysis('seo', 'pdf')">📄 PDF Report</button>
                    <button class="apple-btn btn-secondary" onclick="exportAnalysis('seo', 'slides')">🎯 Slides</button>
                    <button class="apple-btn btn-ghost" onclick="exportAnalysis('seo', 'txt')">📊 Text</button>
                </div>
            </div>
        </div>
    </div>

    <!-- AEO Modal -->
    <div id="aeo-modal" class="cupertino-modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title">🎯 Answer Engine Optimization Analysis</div>
                <button class="modal-close" onclick="closeModal('aeo-modal')">×</button>
            </div>
            <div class="modal-body">
                <div class="health-score">
                    <div class="health-value" style="color: var(--apple-orange);">73.8</div>
                    <div class="health-label">AEO Visibility Score</div>
                    <div class="health-progress">
                        <div class="health-bar" style="width: 73.8%; background: var(--apple-orange)"></div>
                    </div>
                </div>
                <p style="color: var(--text-secondary); text-align: center; margin-bottom: var(--space-8);">
                    Answer Engine Optimization showing <strong style="color: var(--apple-orange);">moderate performance</strong> with significant opportunities for featured snippets and voice search improvements.
                </p>

                <!-- Formula Breakdown -->
                <div style="background: var(--gray-50); padding: var(--space-6); border-radius: var(--radius); margin-bottom: var(--space-6);">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: var(--space-4); color: var(--text-primary);">Score Breakdown</h3>
                    <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 14px;">Brand Mentions (30%)</span>
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <div style="width: 120px; height: 6px; background: var(--gray-200); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 78%; height: 100%; background: var(--apple-orange);"></div>
                                </div>
                                <span style="font-weight: 600; font-size: 14px; min-width: 40px;">78/100</span>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 14px;">Citations (35%)</span>
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <div style="width: 120px; height: 6px; background: var(--gray-200); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 71%; height: 100%; background: var(--apple-orange);"></div>
                                </div>
                                <span style="font-weight: 600; font-size: 14px; min-width: 40px;">71/100</span>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 14px;">Sentiment Score (10%)</span>
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <div style="width: 120px; height: 6px; background: var(--gray-200); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 82%; height: 100%; background: var(--apple-green);"></div>
                                </div>
                                <span style="font-weight: 600; font-size: 14px; min-width: 40px;">82/100</span>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 14px;">Content Quality (15%)</span>
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <div style="width: 120px; height: 6px; background: var(--gray-200); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 68%; height: 100%; background: var(--apple-orange);"></div>
                                </div>
                                <span style="font-weight: 600; font-size: 14px; min-width: 40px;">68/100</span>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 14px;">Share of Voice (10%)</span>
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <div style="width: 120px; height: 6px; background: var(--gray-200); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 75%; height: 100%; background: var(--apple-orange);"></div>
                                </div>
                                <span style="font-weight: 600; font-size: 14px; min-width: 40px;">75/100</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Actionable Items -->
                <div style="margin-bottom: var(--space-6);">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: var(--space-4); color: var(--text-primary);">🎯 Recommended Actions</h3>
                    <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                        <button class="apple-btn btn-primary" onclick="handleAeoAction('citations')" style="justify-content: space-between;">
                            <span>🔗 Increase Featured Snippet Citations (Priority: High)</span>
                            <span style="font-size: 12px; opacity: 0.8;">+10 points</span>
                        </button>
                        <button class="apple-btn btn-secondary" onclick="handleAeoAction('content')" style="justify-content: space-between;">
                            <span>📝 Create Q&A Content for Voice Search</span>
                            <span style="font-size: 12px; opacity: 0.8;">+8 points</span>
                        </button>
                        <button class="apple-btn btn-secondary" onclick="handleAeoAction('schema')" style="justify-content: space-between;">
                            <span>📋 Add FAQ Schema Markup</span>
                            <span style="font-size: 12px; opacity: 0.8;">+7 points</span>
                        </button>
                    </div>
                </div>

                <div style="display: flex; gap: var(--space-3); justify-content: center;">
                    <button class="apple-btn btn-ghost" onclick="exportAnalysis('aeo')">📊 Export Full Report</button>
                </div>
            </div>
        </div>
    </div>

    <!-- GEO Modal -->
    <div id="geo-modal" class="cupertino-modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title">🤖 Generative Engine Optimization Analysis</div>
                <button class="modal-close" onclick="closeModal('geo-modal')">×</button>
            </div>
            <div class="modal-body">
                <div class="health-score">
                    <div class="health-value" style="color: var(--apple-red);">65.2</div>
                    <div class="health-label">GEO Visibility Score</div>
                    <div class="health-progress">
                        <div class="health-bar" style="width: 65.2%; background: var(--apple-red)"></div>
                    </div>
                </div>
                <p style="color: var(--text-secondary); text-align: center; margin-bottom: var(--space-8);">
                    <strong style="color: var(--apple-red);">Critical attention needed.</strong> Your generative engine optimization requires immediate improvements to maintain competitive positioning in AI-driven search results.
                </p>

                <!-- Formula Breakdown -->
                <div style="background: var(--gray-50); padding: var(--space-6); border-radius: var(--radius); margin-bottom: var(--space-6);">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: var(--space-4); color: var(--text-primary);">Score Breakdown</h3>
                    <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 14px;">Brand Mentions (25%)</span>
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <div style="width: 120px; height: 6px; background: var(--gray-200); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 68%; height: 100%; background: var(--apple-orange);"></div>
                                </div>
                                <span style="font-weight: 600; font-size: 14px; min-width: 40px;">68/100</span>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 14px;">Citations (30%)</span>
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <div style="width: 120px; height: 6px; background: var(--gray-200); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 58%; height: 100%; background: var(--apple-red);"></div>
                                </div>
                                <span style="font-weight: 600; font-size: 14px; min-width: 40px; color: var(--apple-red);">58/100</span>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 14px;">Sentiment Score (20%)</span>
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <div style="width: 120px; height: 6px; background: var(--gray-200); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 72%; height: 100%; background: var(--apple-orange);"></div>
                                </div>
                                <span style="font-weight: 600; font-size: 14px; min-width: 40px;">72/100</span>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 14px;">Content Quality (15%)</span>
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <div style="width: 120px; height: 6px; background: var(--gray-200); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 61%; height: 100%; background: var(--apple-red);"></div>
                                </div>
                                <span style="font-weight: 600; font-size: 14px; min-width: 40px; color: var(--apple-red);">61/100</span>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 14px;">Share of Voice (10%)</span>
                            <div style="display: flex; align-items: center; gap: var(--space-2);">
                                <div style="width: 120px; height: 6px; background: var(--gray-200); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 67%; height: 100%; background: var(--apple-orange);"></div>
                                </div>
                                <span style="font-weight: 600; font-size: 14px; min-width: 40px;">67/100</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Critical Issues Alert -->
                <div style="background: linear-gradient(135deg, rgba(255, 59, 48, 0.1), transparent); padding: var(--space-6); border-radius: var(--radius); border-left: 4px solid var(--apple-red); margin-bottom: var(--space-6);">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: var(--space-3); color: var(--apple-red);">🚨 Critical Issues Detected</h3>
                    <ul style="margin: 0; padding-left: var(--space-6); color: var(--text-secondary); line-height: 1.8;">
                        <li>Low AI model citations (58/100) - Gemini only 12 citations</li>
                        <li>Poor content structure for AI understanding (61/100)</li>
                        <li>Missing FAQ and AutoDealer schema markup</li>
                        <li>67% below industry average for generative AI visibility</li>
                    </ul>
                </div>

                <!-- Actionable Items -->
                <div style="margin-bottom: var(--space-6);">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: var(--space-4); color: var(--text-primary);">⚡ Emergency Action Items</h3>
                    <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                        <button class="apple-btn btn-primary" onclick="handleGeoAction('citations')" style="justify-content: space-between; background: var(--apple-red);">
                            <span>🚨 Fix Gemini AI Citations (CRITICAL)</span>
                            <span style="font-size: 12px; opacity: 0.8;">+15 points</span>
                        </button>
                        <button class="apple-btn btn-primary" onclick="handleGeoAction('content')" style="justify-content: space-between;">
                            <span>📝 Restructure Content for AI Models (HIGH)</span>
                            <span style="font-size: 12px; opacity: 0.8;">+12 points</span>
                        </button>
                        <button class="apple-btn btn-secondary" onclick="handleGeoAction('schema')" style="justify-content: space-between;">
                            <span>📋 Implement AI-Optimized Schema</span>
                            <span style="font-size: 12px; opacity: 0.8;">+8 points</span>
                        </button>
                        <button class="apple-btn btn-secondary" onclick="handleGeoAction('training')" style="justify-content: space-between;">
                            <span>🤖 Train AI Models on Your Content</span>
                            <span style="font-size: 12px; opacity: 0.8;">+10 points</span>
                        </button>
                    </div>
                </div>

                <div style="display: flex; gap: var(--space-3); justify-content: center;">
                    <button class="apple-btn btn-ghost" onclick="exportAnalysis('geo')">📊 Export Emergency Report</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Cupertino-style JavaScript
        function initializeDashboard() {
            updateTime();
            setInterval(updateTime, 60000);
            animateProgressBars();
        }

        function updateTime() {
            const now = new Date();
            const options = {
                month: 'short',
                day: 'numeric',
                year: 'numeric',
                hour: 'numeric',
                minute: '2-digit',
                hour12: true
            };
            document.getElementById('current-time').textContent = now.toLocaleDateString('en-US', options);
        }

        function switchTab(tabName) {
            // Remove active from all tabs and content
            document.querySelectorAll('.apple-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            // Add active to selected
            event.target.classList.add('active');
            const selectedContent = document.getElementById(tabName);
            if (selectedContent) {
                selectedContent.classList.add('active');
            }
        }

        // API Key Management Functions
        function toggleApiKeyVisibility(inputId) {
            const input = document.getElementById(inputId);
            if (input.type === 'password') {
                input.type = 'text';
                event.target.textContent = '🙈';
            } else {
                input.type = 'password';
                event.target.textContent = '👁️';
            }
        }

        async function saveApiKeys() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '💾 Saving...';
            btn.disabled = true;

            try {
                // Get API key values
                const apiKeys = {
                    google_analytics_key: document.getElementById('ga-api-key').value,
                    google_search_console_key: document.getElementById('gsc-api-key').value,
                    google_my_business_key: document.getElementById('gmb-api-key').value,
                    facebook_access_token: document.getElementById('fb-access-token').value,
                    yelp_api_key: document.getElementById('yelp-api-key').value,
                    active: true,
                    environment: 'production'
                };

                // Validate all keys are provided
                const emptyKeys = Object.entries(apiKeys)
                    .filter(([key, value]) => key !== 'active' && key !== 'environment' && (!value || value.trim() === ''))
                    .map(([key]) => key);

                if (emptyKeys.length > 0) {
                    showNotification('⚠️ Missing API Keys', `Please fill in all API keys. Missing: ${emptyKeys.join(', ')}`, 'warning');
                    return;
                }

                // Save to Supabase
                const response = await saveApiKeysToDatabase(apiKeys);

                if (response.success) {
                    showNotification('✅ API Keys Saved', 'All API keys have been securely saved to the database.', 'success');

                    // Update connection status
                    updateConnectionStatus();

                    // Test connections automatically
                    setTimeout(() => {
                        testAllApiConnections();
                    }, 1000);
                } else {
                    throw new Error(response.error || 'Failed to save API keys');
                }

            } catch (error) {
                console.error('Error saving API keys:', error);
                showNotification('❌ Save Failed', 'Failed to save API keys: ' + error.message, 'error');
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        async function loadApiKeys() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '🔄 Loading...';
            btn.disabled = true;

            try {
                // Load from Supabase
                const apiKeys = await loadApiKeysFromDatabase();

                if (apiKeys) {
                    // Populate fields (show masked values for security)
                    document.getElementById('ga-api-key').value = maskApiKey(apiKeys.google_analytics_key);
                    document.getElementById('gsc-api-key').value = maskApiKey(apiKeys.google_search_console_key);
                    document.getElementById('gmb-api-key').value = maskApiKey(apiKeys.google_my_business_key);
                    document.getElementById('fb-access-token').value = maskApiKey(apiKeys.facebook_access_token);
                    document.getElementById('yelp-api-key').value = maskApiKey(apiKeys.yelp_api_key);

                    showNotification('✅ API Keys Loaded', 'Current API keys have been loaded (masked for security).', 'success');
                    updateConnectionStatus();
                } else {
                    showNotification('ℹ️ No Keys Found', 'No API keys found in database. Please add your keys.', 'info');
                }

            } catch (error) {
                console.error('Error loading API keys:', error);
                showNotification('❌ Load Failed', 'Failed to load API keys: ' + error.message, 'error');
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        async function testGoogleApis() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '🧪 Testing...';
            btn.disabled = true;

            try {
                const results = await testGoogleApiConnections();

                if (results.allPassed) {
                    showNotification('✅ Google APIs Connected', 'All Google API connections are working properly.', 'success');
                    updateStatusIndicator('google-status', 'google-status-text', 'success', 'All connected');
                } else {
                    const failedAPIs = results.failed.join(', ');
                    showNotification('⚠️ Some APIs Failed', `Failed connections: ${failedAPIs}`, 'warning');
                    updateStatusIndicator('google-status', 'google-status-text', 'warning', `${results.passed.length}/3 connected`);
                }

            } catch (error) {
                console.error('Error testing Google APIs:', error);
                showNotification('❌ Test Failed', 'Failed to test Google APIs: ' + error.message, 'error');
                updateStatusIndicator('google-status', 'google-status-text', 'error', 'Connection failed');
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        async function testSocialApis() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '🧪 Testing...';
            btn.disabled = true;

            try {
                const results = await testSocialApiConnections();

                if (results.allPassed) {
                    showNotification('✅ Social APIs Connected', 'All social media API connections are working properly.', 'success');
                    updateStatusIndicator('social-status', 'social-status-text', 'success', 'All connected');
                } else {
                    const failedAPIs = results.failed.join(', ');
                    showNotification('⚠️ Some APIs Failed', `Failed connections: ${failedAPIs}`, 'warning');
                    updateStatusIndicator('social-status', 'social-status-text', 'warning', `${results.passed.length}/2 connected`);
                }

            } catch (error) {
                console.error('Error testing social APIs:', error);
                showNotification('❌ Test Failed', 'Failed to test social APIs: ' + error.message, 'error');
                updateStatusIndicator('social-status', 'social-status-text', 'error', 'Connection failed');
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        // Utility Functions
        function maskApiKey(apiKey) {
            if (!apiKey || apiKey.startsWith('GA_KEY_PLACEHOLDER') || apiKey.startsWith('GSC_KEY_PLACEHOLDER')) {
                return '';
            }
            // Show first 8 and last 4 characters, mask the rest
            const start = apiKey.substring(0, 8);
            const end = apiKey.substring(apiKey.length - 4);
            const masked = '*'.repeat(Math.max(0, apiKey.length - 12));
            return start + masked + end;
        }

        function updateStatusIndicator(statusId, textId, status, text) {
            const indicator = document.getElementById(statusId);
            const textElement = document.getElementById(textId);

            const colors = {
                success: 'var(--apple-green)',
                warning: 'var(--apple-orange)',
                error: 'var(--apple-red)',
                inactive: 'var(--gray-400)'
            };

            if (indicator) indicator.style.background = colors[status];
            if (textElement) textElement.textContent = text;
        }

        function updateConnectionStatus() {
            // Update status based on whether keys are configured
            const hasGoogleKeys = ['ga-api-key', 'gsc-api-key', 'gmb-api-key'].some(id =>
                document.getElementById(id).value && !document.getElementById(id).value.startsWith('*'));
            const hasSocialKeys = ['fb-access-token', 'yelp-api-key'].some(id =>
                document.getElementById(id).value && !document.getElementById(id).value.startsWith('*'));

            updateStatusIndicator('google-status', 'google-status-text',
                hasGoogleKeys ? 'warning' : 'inactive',
                hasGoogleKeys ? 'Configured (not tested)' : 'Not configured');

            updateStatusIndicator('social-status', 'social-status-text',
                hasSocialKeys ? 'warning' : 'inactive',
                hasSocialKeys ? 'Configured (not tested)' : 'Not configured');
        }

        async function testAllApiConnections() {
            try {
                showNotification('🔄 Testing All APIs', 'Running comprehensive API connection tests...', 'info');

                const [googleResults, socialResults] = await Promise.all([
                    testGoogleApiConnections(),
                    testSocialApiConnections()
                ]);

                const totalPassed = googleResults.passed.length + socialResults.passed.length;
                const totalTests = 5; // 3 Google + 2 Social

                // Update metrics
                document.getElementById('success-rate').textContent = Math.round((totalPassed / totalTests) * 100) + '%';
                document.getElementById('api-calls-today').textContent = '12'; // Simulated
                document.getElementById('response-time').textContent = '250ms'; // Simulated
                document.getElementById('failed-requests').textContent = String(totalTests - totalPassed);

                if (totalPassed === totalTests) {
                    showNotification('🎉 All APIs Connected', 'Perfect! All API connections are working properly.', 'success');
                } else {
                    showNotification('⚠️ Some Issues Found', `${totalPassed}/${totalTests} APIs connected successfully.`, 'warning');
                }

            } catch (error) {
                console.error('Error in comprehensive API test:', error);
                showNotification('❌ Test Failed', 'Failed to run comprehensive API tests.', 'error');
            }
        }

        // Make functions globally available
        window.switchTab = switchTab;
        window.launchExecutiveAnalysis = launchExecutiveAnalysis;
        window.generateCSuiteReport = generateCSuiteReport;
        window.executeBulkActions = executeBulkActions;
        window.optimizeAICitations = optimizeAICitations;
        window.syncEcosystem = syncEcosystem;
        window.toggleApiKeyVisibility = toggleApiKeyVisibility;
        window.saveApiKeys = saveApiKeys;
        window.loadApiKeys = loadApiKeys;
        window.testGoogleApis = testGoogleApis;
        window.testSocialApis = testSocialApis;

        // Supabase Integration Functions
        async function saveApiKeysToDatabase(apiKeys) {
            try {
                const supabaseUrl = 'https://gzlgfghpkbqlhgfozjkb.supabase.co';
                const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd6bGdmZ2hwa2JxbGhnZm96amtiIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NTM5ODUwNCwiZXhwIjoyMDcwOTc0NTA0fQ.nud8cCUmdqw5WFi5bOZ8jeIf2GGFjeKIcWDhERb_-gk';

                const response = await fetch(`${supabaseUrl}/rest/v1/api_keys`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'apikey': supabaseKey,
                        'Authorization': `Bearer ${supabaseKey}`,
                        'Prefer': 'return=minimal'
                    },
                    body: JSON.stringify(apiKeys)
                });

                if (response.ok) {
                    return { success: true };
                } else {
                    const errorData = await response.text();
                    return { success: false, error: errorData };
                }

            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        async function loadApiKeysFromDatabase() {
            try {
                const supabaseUrl = 'https://gzlgfghpkbqlhgfozjkb.supabase.co';
                const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd6bGdmZ2hwa2JxbGhnZm96amtiIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NTM5ODUwNCwiZXhwIjoyMDcwOTc0NTA0fQ.nud8cCUmdqw5WFi5bOZ8jeIf2GGFjeKIcWDhERb_-gk';

                const response = await fetch(`${supabaseUrl}/rest/v1/api_keys?active=eq.true&environment=eq.production&limit=1`, {
                    method: 'GET',
                    headers: {
                        'apikey': supabaseKey,
                        'Authorization': `Bearer ${supabaseKey}`
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    return data.length > 0 ? data[0] : null;
                } else {
                    throw new Error('Failed to load API keys');
                }

            } catch (error) {
                console.error('Error loading API keys:', error);
                return null;
            }
        }

        // API Testing Functions
        async function testGoogleApiConnections() {
            const results = { passed: [], failed: [], allPassed: false };

            try {
                // Test Google Analytics
                try {
                    const gaKey = document.getElementById('ga-api-key').value;
                    if (gaKey && !gaKey.startsWith('*')) {
                        // Simulate API test (replace with actual Google Analytics API call)
                        const gaResponse = await testApiEndpoint('https://analyticsreporting.googleapis.com/v4/reports:batchGet', gaKey);
                        results.passed.push('Google Analytics');
                    } else {
                        throw new Error('No API key provided');
                    }
                } catch (error) {
                    results.failed.push('Google Analytics');
                }

                // Test Google Search Console
                try {
                    const gscKey = document.getElementById('gsc-api-key').value;
                    if (gscKey && !gscKey.startsWith('*')) {
                        // Simulate API test (replace with actual Search Console API call)
                        const gscResponse = await testApiEndpoint('https://www.googleapis.com/webmasters/v3/sites', gscKey);
                        results.passed.push('Search Console');
                    } else {
                        throw new Error('No API key provided');
                    }
                } catch (error) {
                    results.failed.push('Search Console');
                }

                // Test Google My Business
                try {
                    const gmbKey = document.getElementById('gmb-api-key').value;
                    if (gmbKey && !gmbKey.startsWith('*')) {
                        // Simulate API test (replace with actual My Business API call)
                        const gmbResponse = await testApiEndpoint('https://mybusinessbusinessinformation.googleapis.com/v1', gmbKey);
                        results.passed.push('My Business');
                    } else {
                        throw new Error('No API key provided');
                    }
                } catch (error) {
                    results.failed.push('My Business');
                }

                results.allPassed = results.failed.length === 0 && results.passed.length > 0;
                return results;

            } catch (error) {
                console.error('Error testing Google APIs:', error);
                return { passed: [], failed: ['All Google APIs'], allPassed: false };
            }
        }

        async function testSocialApiConnections() {
            const results = { passed: [], failed: [], allPassed: false };

            try {
                // Test Facebook API
                try {
                    const fbToken = document.getElementById('fb-access-token').value;
                    if (fbToken && !fbToken.startsWith('*')) {
                        // Simulate API test (replace with actual Facebook API call)
                        const fbResponse = await testApiEndpoint('https://graph.facebook.com/v18.0/me', fbToken);
                        results.passed.push('Facebook');
                    } else {
                        throw new Error('No access token provided');
                    }
                } catch (error) {
                    results.failed.push('Facebook');
                }

                // Test Yelp API
                try {
                    const yelpKey = document.getElementById('yelp-api-key').value;
                    if (yelpKey && !yelpKey.startsWith('*')) {
                        // Simulate API test (replace with actual Yelp API call)
                        const yelpResponse = await testApiEndpoint('https://api.yelp.com/v3/businesses/search', yelpKey);
                        results.passed.push('Yelp');
                    } else {
                        throw new Error('No API key provided');
                    }
                } catch (error) {
                    results.failed.push('Yelp');
                }

                results.allPassed = results.failed.length === 0 && results.passed.length > 0;
                return results;

            } catch (error) {
                console.error('Error testing social APIs:', error);
                return { passed: [], failed: ['All Social APIs'], allPassed: false };
            }
        }

        async function testApiEndpoint(url, apiKey) {
            // For now, simulate API testing since we don't have real keys
            // In production, this would make actual API calls to test connectivity

            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    // Simulate 80% success rate for testing
                    if (Math.random() > 0.2) {
                        resolve({ status: 'success', message: 'API connection successful' });
                    } else {
                        reject(new Error('API connection failed'));
                    }
                }, 500 + Math.random() * 1000); // Random delay 500-1500ms
            });
        }

        function animateProgressBars() {
            const progressBars = document.querySelectorAll('.progress-fill, .health-bar');
            progressBars.forEach(bar => {
                const width = bar.style.width;
                bar.style.width = '0%';
                setTimeout(() => {
                    bar.style.width = width;
                }, 100);
            });
        }

        // Optimized modal functions for INP performance
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (!modal) return;

            // Immediate show without blocking
            requestAnimationFrame(() => {
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';

                // Defer animations to prevent blocking
                requestAnimationFrame(() => {
                    const progressBars = modal.querySelectorAll('.health-bar');
                    progressBars.forEach(bar => {
                        const width = bar.style.width;
                        bar.style.width = '0%';
                        requestAnimationFrame(() => {
                            setTimeout(() => bar.style.width = width, 200);
                        });
                    });
                });
            });
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (!modal) return;

            // Non-blocking close
            requestAnimationFrame(() => {
                modal.classList.remove('show');
                document.body.style.overflow = '';
            });
        }

        // CTA Button Functions
        function launchExecutiveAnalysis() {
            // Show loading state
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '🔄 Launching Analysis...';
            btn.disabled = true;

            // Simulate analysis launch
            setTimeout(() => {
                showNotification('✅ Executive Analysis Launched', 'Advanced analytics are now running. Report will be ready in 15 minutes.', 'success');
                btn.innerHTML = originalText;
                btn.disabled = false;

                // Switch to AI Health tab to show analysis
                switchTabByName('ai-health');
            }, 2000);
        }

        function generateCSuiteReport() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '📊 Generating...';
            btn.disabled = true;

            setTimeout(() => {
                // Create downloadable report
                const reportData = {
                    title: 'DealershipAI Executive Report',
                    date: new Date().toLocaleDateString(),
                    metrics: {
                        seoVisibility: '87.3%',
                        aeoVisibility: '73.8%',
                        geoVisibility: '65.2%',
                        revenueAtRisk: '$367K',
                        searchVisibility: '92%',
                        websiteHealth: '87%'
                    }
                };

                downloadReport(reportData);
                showNotification('📄 C-Suite Report Generated', 'Executive summary downloaded successfully.', 'success');
                btn.innerHTML = originalText;
                btn.disabled = false;
            }, 3000);
        }

        function executeBulkActions() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '⚡ Executing...';
            btn.disabled = true;

            const actions = [
                'Updating schema markup...',
                'Optimizing citation profiles...',
                'Refreshing API connections...',
                'Syncing review responses...',
                'Updating competitive data...'
            ];

            let actionIndex = 0;
            const actionInterval = setInterval(() => {
                if (actionIndex < actions.length) {
                    showNotification('🔄 Bulk Action', actions[actionIndex], 'info');
                    actionIndex++;
                } else {
                    clearInterval(actionInterval);
                    showNotification('✅ Bulk Actions Complete', 'All 5 optimization tasks completed successfully.', 'success');
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }
            }, 1000);
        }

        function optimizeAICitations() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '🤖 Optimizing...';
            btn.disabled = true;

            setTimeout(() => {
                // Simulate AI citation optimization
                const improvements = [
                    'Updated 47 citation mentions',
                    'Improved sentiment scoring by 12%',
                    'Enhanced content relevance',
                    'Optimized for 3 new AI platforms'
                ];

                improvements.forEach((improvement, index) => {
                    setTimeout(() => {
                        showNotification('🤖 AI Optimization', improvement, 'info');
                    }, index * 500);
                });

                setTimeout(() => {
                    showNotification('✅ AI Citations Optimized', 'Citation performance improved by 15%. GEO score updated.', 'success');
                    btn.innerHTML = originalText;
                    btn.disabled = false;

                    // Update the GEO visibility score
                    const geoScore = document.querySelector('.geo .score-value');
                    if (geoScore) {
                        geoScore.textContent = '68.5';
                        geoScore.parentElement.querySelector('.progress-fill').style.width = '68.5%';
                    }
                }, 2500);
            }, 1000);
        }

        function syncEcosystem() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '🔄 Syncing...';
            btn.disabled = true;

            const platforms = [
                'Google Analytics',
                'Search Console',
                'Google My Business',
                'Facebook Business',
                'Yelp API',
                'Review Platforms',
                'Schema Validators'
            ];

            let syncIndex = 0;
            const syncInterval = setInterval(() => {
                if (syncIndex < platforms.length) {
                    showNotification('🔄 Ecosystem Sync', `Syncing ${platforms[syncIndex]}...`, 'info');
                    syncIndex++;
                } else {
                    clearInterval(syncInterval);
                    showNotification('✅ Ecosystem Synchronized', 'All 7 platforms connected and data refreshed.', 'success');
                    btn.innerHTML = originalText;
                    btn.disabled = false;

                    // Update connection status
                    const statusText = document.querySelector('[style*="7/8 Platforms Connected"]');
                    if (statusText) {
                        statusText.textContent = '8/8 Platforms Connected';
                    }
                }
            }, 800);
        }

        // Utility Functions
        function switchTabByName(tabName) {
            document.querySelectorAll('.apple-tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.getAttribute('onclick').includes(tabName)) {
                    tab.classList.add('active');
                }
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            const selectedContent = document.getElementById(tabName);
            if (selectedContent) {
                selectedContent.classList.add('active');
            }
        }

        // Modal Action Handlers with optimized INP performance
        function handleSeoAction(actionType) {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.disabled = true;
            btn.style.opacity = '0.6';

            requestAnimationFrame(() => {
                switch(actionType) {
                    case 'content':
                        btn.innerHTML = '🔄 Analyzing content...';
                        setTimeout(() => {
                            showNotification('📝 Content Optimization Started', 'Analyzing 47 pages for quality improvements. Expected completion: 15 minutes.', 'info');
                            setTimeout(() => {
                                btn.innerHTML = originalText;
                                btn.disabled = false;
                                btn.style.opacity = '1';
                                closeModal('seo-modal');
                            }, 1500);
                        }, 800);
                        break;
                    case 'citations':
                        btn.innerHTML = '🔄 Building citations...';
                        setTimeout(() => {
                            showNotification('🔗 Citation Strategy Created', 'Identified 23 high-authority opportunities. Implementation guide sent to your email.', 'success');
                            setTimeout(() => {
                                btn.innerHTML = originalText;
                                btn.disabled = false;
                                btn.style.opacity = '1';
                                closeModal('seo-modal');
                            }, 1500);
                        }, 800);
                        break;
                    case 'technical':
                        btn.innerHTML = '🔄 Running audit...';
                        setTimeout(() => {
                            showNotification('⚙️ Technical Audit Complete', 'Found 8 optimization opportunities. Detailed report available in dashboard.', 'success');
                            setTimeout(() => {
                                btn.innerHTML = originalText;
                                btn.disabled = false;
                                btn.style.opacity = '1';
                                closeModal('seo-modal');
                            }, 1500);
                        }, 800);
                        break;
                }
            });
        }

        function handleAeoAction(actionType) {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.disabled = true;
            btn.style.opacity = '0.6';

            requestAnimationFrame(() => {
                switch(actionType) {
                    case 'citations':
                        btn.innerHTML = '🔄 Optimizing snippets...';
                        setTimeout(() => {
                            showNotification('🎯 Featured Snippet Optimization', 'Targeting 34 snippet opportunities. Content templates generated and ready for review.', 'success');
                            setTimeout(() => {
                                btn.innerHTML = originalText;
                                btn.disabled = false;
                                btn.style.opacity = '1';
                                closeModal('aeo-modal');
                            }, 1500);
                        }, 800);
                        break;
                    case 'content':
                        btn.innerHTML = '🔄 Creating Q&A content...';
                        setTimeout(() => {
                            showNotification('📝 Voice Search Content Created', 'Generated 50 Q&A pairs optimized for voice search. Ready for publishing.', 'success');
                            setTimeout(() => {
                                btn.innerHTML = originalText;
                                btn.disabled = false;
                                btn.style.opacity = '1';
                                closeModal('aeo-modal');
                            }, 1500);
                        }, 800);
                        break;
                    case 'schema':
                        btn.innerHTML = '🔄 Implementing schema...';
                        setTimeout(() => {
                            showNotification('📋 FAQ Schema Added', 'FAQ schema markup implemented on 15 key pages. Validation passed.', 'success');
                            setTimeout(() => {
                                btn.innerHTML = originalText;
                                btn.disabled = false;
                                btn.style.opacity = '1';
                                closeModal('aeo-modal');
                            }, 1500);
                        }, 800);
                        break;
                }
            });
        }

        function handleGeoAction(actionType) {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.disabled = true;
            btn.style.opacity = '0.6';

            requestAnimationFrame(() => {
                switch(actionType) {
                    case 'citations':
                        btn.innerHTML = '🔄 Optimizing AI citations...';
                        setTimeout(() => {
                            showNotification('🚨 CRITICAL: Gemini Citations Fixed', 'Implemented AI-optimized content structure. Citations increased from 12 to 47 (estimated). Monitoring in progress.', 'success');
                            setTimeout(() => {
                                btn.innerHTML = originalText;
                                btn.disabled = false;
                                btn.style.opacity = '1';
                                closeModal('geo-modal');
                            }, 1500);
                        }, 1000);
                        break;
                    case 'content':
                        btn.innerHTML = '🔄 Restructuring content...';
                        setTimeout(() => {
                            showNotification('📝 Content Restructured for AI', 'Applied AI-first content patterns to 32 pages. Improved semantic structure and entity recognition.', 'success');
                            setTimeout(() => {
                                btn.innerHTML = originalText;
                                btn.disabled = false;
                                btn.style.opacity = '1';
                                closeModal('geo-modal');
                            }, 1500);
                        }, 1000);
                        break;
                    case 'schema':
                        btn.innerHTML = '🔄 Implementing AI schema...';
                        setTimeout(() => {
                            showNotification('📋 AI-Optimized Schema Live', 'Deployed AutoDealer, FAQ, and enhanced entity schemas. AI crawlers notified.', 'success');
                            setTimeout(() => {
                                btn.innerHTML = originalText;
                                btn.disabled = false;
                                btn.style.opacity = '1';
                                closeModal('geo-modal');
                            }, 1500);
                        }, 1000);
                        break;
                    case 'training':
                        btn.innerHTML = '🔄 Training AI models...';
                        setTimeout(() => {
                            showNotification('🤖 AI Training Initiated', 'Submitted content to ChatGPT, Gemini, and Perplexity training pipelines. Processing begins within 48 hours.', 'info');
                            setTimeout(() => {
                                btn.innerHTML = originalText;
                                btn.disabled = false;
                                btn.style.opacity = '1';
                                closeModal('geo-modal');
                            }, 1500);
                        }, 1000);
                        break;
                }
            });
        }

        // Show dependencies modal
        function showDependencies(modalType, actionType) {
            const dependencies = {
                seo: {
                    content: { before: ['Technical Audit'], after: ['Citations'], parallel: [] },
                    citations: { before: ['Content Optimization'], after: [], parallel: ['Technical Audit'] },
                    technical: { before: [], after: ['Content Optimization'], parallel: ['Citations'] }
                },
                aeo: {
                    citations: { before: ['Schema Implementation'], after: ['Content Creation'], parallel: [] },
                    content: { before: ['Citations'], after: [], parallel: ['Schema'] },
                    schema: { before: [], after: ['Citations'], parallel: ['Content'] }
                },
                geo: {
                    citations: { before: ['Content Restructure', 'Schema'], after: [], parallel: [] },
                    content: { before: ['Schema'], after: ['Citations', 'Training'], parallel: [] },
                    schema: { before: [], after: ['Content', 'Citations'], parallel: [] },
                    training: { before: ['Content', 'Citations'], after: [], parallel: [] }
                }
            };

            const dep = dependencies[modalType][actionType];
            const actionNames = {
                content: 'Content Optimization',
                citations: 'Citation Building',
                technical: 'Technical Audit',
                schema: 'Schema Implementation',
                training: 'AI Training'
            };

            let html = `
                <div style="background: white; padding: var(--space-6); border-radius: var(--radius); max-width: 500px; margin: 20px;">
                    <h3 style="margin-bottom: var(--space-4);">🔗 Action Dependencies</h3>
                    <div style="text-align: center; padding: var(--space-4); background: var(--gray-50); border-radius: var(--radius); margin-bottom: var(--space-4);">
                        <div style="font-weight: 600; font-size: 16px;">${actionNames[actionType]}</div>
                    </div>`;

            if (dep.before.length > 0) {
                html += `<div style="margin-bottom: var(--space-4);">
                    <div style="font-size: 13px; font-weight: 600; color: var(--apple-orange); margin-bottom: var(--space-2);">⬇️ Do These First:</div>`;
                dep.before.forEach(d => {
                    html += `<div style="padding: var(--space-2); background: rgba(255, 149, 0, 0.1); border-radius: var(--radius-sm); margin-bottom: var(--space-1); font-size: 13px;">${d}</div>`;
                });
                html += `</div>`;
            }

            if (dep.parallel.length > 0) {
                html += `<div style="margin-bottom: var(--space-4);">
                    <div style="font-size: 13px; font-weight: 600; color: var(--apple-blue); margin-bottom: var(--space-2);">↔️ Can Run In Parallel:</div>`;
                dep.parallel.forEach(d => {
                    html += `<div style="padding: var(--space-2); background: rgba(0, 122, 255, 0.1); border-radius: var(--radius-sm); margin-bottom: var(--space-1); font-size: 13px;">${d}</div>`;
                });
                html += `</div>`;
            }

            if (dep.after.length > 0) {
                html += `<div style="margin-bottom: var(--space-4);">
                    <div style="font-size: 13px; font-weight: 600; color: var(--apple-green); margin-bottom: var(--space-2);">⬆️ Unlocks These Actions:</div>`;
                dep.after.forEach(d => {
                    html += `<div style="padding: var(--space-2); background: rgba(52, 199, 89, 0.1); border-radius: var(--radius-sm); margin-bottom: var(--space-1); font-size: 13px;">${d}</div>`;
                });
                html += `</div>`;
            }

            html += `<button onclick="closePreview()" class="apple-btn btn-primary" style="width: 100%;">Got it!</button></div>`;

            showPreviewModal(html);
        }

        // Show before/after preview
        function showPreview(modalType, actionType) {
            const previews = {
                seo: {
                    content: {
                        before: `<h3>Current Content Structure</h3>
                            <div style="padding: var(--space-4); background: rgba(255, 59, 48, 0.1); border-radius: var(--radius); font-size: 13px; font-family: monospace;">
                                About Our Dealership<br/>
                                We sell cars. Visit us today.<br/>
                                <span style="color: var(--apple-red);">❌ Thin content (12 words)</span><br/>
                                <span style="color: var(--apple-red);">❌ No keywords</span><br/>
                                <span style="color: var(--apple-red);">❌ No structured data</span>
                            </div>`,
                        after: `<h3>Optimized Content Structure</h3>
                            <div style="padding: var(--space-4); background: rgba(52, 199, 89, 0.1); border-radius: var(--radius); font-size: 13px; font-family: monospace;">
                                Your Premier Honda Dealership in [City]<br/>
                                Discover quality pre-owned and new Honda vehicles...<br/>
                                <span style="color: var(--apple-green);">✅ Rich content (450+ words)</span><br/>
                                <span style="color: var(--apple-green);">✅ Target keywords integrated</span><br/>
                                <span style="color: var(--apple-green);">✅ FAQ schema ready</span>
                            </div>`
                    },
                    citations: {
                        before: '<h3>Current Citations: 12</h3><div style="font-size: 13px; color: var(--text-secondary);">Limited presence on industry directories</div>',
                        after: '<h3>Target Citations: 35+</h3><div style="font-size: 13px; color: var(--apple-green);">✅ Google My Business • ✅ Cars.com • ✅ Autotrader • ✅ CarGurus • ✅ Local directories (23)</div>'
                    },
                    technical: {
                        before: '<h3>Current: 2.8s Load Time</h3><div style="font-size: 13px; color: var(--apple-red);">❌ LCP: 3.2s • ❌ FID: 210ms • ❌ CLS: 0.18</div>',
                        after: '<h3>Optimized: 1.2s Load Time</h3><div style="font-size: 13px; color: var(--apple-green);">✅ LCP: 1.4s • ✅ FID: 45ms • ✅ CLS: 0.05</div>'
                    }
                }
            };

            const preview = previews[modalType]?.[actionType];
            if (!preview) {
                showNotification('Preview Not Available', 'This preview is still being generated.', 'info');
                return;
            }

            const html = `
                <div style="background: white; padding: var(--space-6); border-radius: var(--radius); max-width: 600px; margin: 20px;">
                    <h3 style="margin-bottom: var(--space-6);">👁️ Before & After Preview</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-4); margin-bottom: var(--space-6);">
                        <div>
                            <div style="background: rgba(255, 59, 48, 0.1); padding: var(--space-2); border-radius: var(--radius-sm); margin-bottom: var(--space-3); text-align: center; font-weight: 600; font-size: 13px; color: var(--apple-red);">❌ BEFORE</div>
                            ${preview.before}
                        </div>
                        <div>
                            <div style="background: rgba(52, 199, 89, 0.1); padding: var(--space-2); border-radius: var(--radius-sm); margin-bottom: var(--space-3); text-align: center; font-weight: 600; font-size: 13px; color: var(--apple-green);">✅ AFTER</div>
                            ${preview.after}
                        </div>
                    </div>
                    <button onclick="closePreview()" class="apple-btn btn-primary" style="width: 100%;">Close Preview</button>
                </div>`;

            showPreviewModal(html);
        }

        // Helper to show preview modal
        function showPreviewModal(html) {
            const overlay = document.createElement('div');
            overlay.id = 'preview-overlay';
            overlay.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 10000; display: flex; align-items: center; justify-content: center; padding: 20px; overflow-y: auto;';
            overlay.innerHTML = html;
            overlay.onclick = (e) => { if (e.target === overlay) closePreview(); };
            document.body.appendChild(overlay);
            requestAnimationFrame(() => overlay.style.opacity = '1');
        }

        function closePreview() {
            const overlay = document.getElementById('preview-overlay');
            if (overlay) {
                overlay.style.opacity = '0';
                setTimeout(() => overlay.remove(), 200);
            }
        }

        function exportAnalysis(type, format = 'txt') {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.disabled = true;
            btn.innerHTML = '📊 Exporting...';

            requestAnimationFrame(() => {
                setTimeout(() => {
                    const reportName = {
                        'seo': 'SEO-Visibility-Analysis',
                        'aeo': 'AEO-Visibility-Analysis',
                        'geo': 'GEO-Emergency-Report'
                    }[type];

                    if (format === 'pdf') {
                        showNotification('📄 PDF Export', 'PDF generation started. Report will download in 5 seconds...', 'info');
                        setTimeout(() => {
                            showNotification('✅ PDF Ready', `${reportName}.pdf has been downloaded successfully!`, 'success');
                        }, 5000);
                        btn.innerHTML = originalText;
                        btn.disabled = false;
                        return;
                    }

                    if (format === 'slides') {
                        showNotification('🎯 Slides Generated', 'PowerPoint presentation ready. Opening preview...', 'success');
                        setTimeout(() => {
                            window.open('about:blank', '_blank');
                        }, 1500);
                        btn.innerHTML = originalText;
                        btn.disabled = false;
                        return;
                    }

                    const reportContent = `
DealershipAI ${reportName}
Generated: ${new Date().toLocaleString()}
==================================================

${type.toUpperCase()} VISIBILITY SCORE
Score: ${type === 'seo' ? '87.3' : type === 'aeo' ? '73.8' : '65.2'}/100
Status: ${type === 'seo' ? 'Strong Performance' : type === 'aeo' ? 'Improving' : 'Critical Attention Needed'}

DETAILED BREAKDOWN
--------------------------------------------------
${type === 'seo' ? `
Brand Mentions: 92/100 (20% weight)
Citations: 88/100 (25% weight)
Sentiment: 85/100 (15% weight)
Content Quality: 81/100 (25% weight)
Share of Voice: 89/100 (15% weight)
` : type === 'aeo' ? `
Brand Mentions: 78/100 (30% weight)
Citations: 71/100 (35% weight)
Sentiment: 82/100 (10% weight)
Content Quality: 68/100 (15% weight)
Share of Voice: 75/100 (10% weight)
` : `
Brand Mentions: 68/100 (25% weight)
Citations: 58/100 (30% weight) ⚠️ CRITICAL
Sentiment: 72/100 (20% weight)
Content Quality: 61/100 (15% weight) ⚠️ CRITICAL
Share of Voice: 67/100 (10% weight)
`}

RECOMMENDED ACTIONS
--------------------------------------------------
${type === 'seo' ? `
1. Optimize Content Quality (Priority: Medium) - +6 points
2. Build More Citations - +4 points
3. Technical SEO Audit - +3 points
` : type === 'aeo' ? `
1. Increase Featured Snippet Citations (Priority: High) - +10 points
2. Create Q&A Content for Voice Search - +8 points
3. Add FAQ Schema Markup - +7 points
` : `
1. Fix Gemini AI Citations (CRITICAL) - +15 points
2. Restructure Content for AI Models (HIGH) - +12 points
3. Implement AI-Optimized Schema - +8 points
4. Train AI Models on Your Content - +10 points

CRITICAL ISSUES:
- Low AI model citations (58/100) - Gemini only 12 citations
- Poor content structure for AI understanding (61/100)
- Missing FAQ and AutoDealer schema markup
- 67% below industry average for generative AI visibility
`}

For implementation support, contact your DealershipAI success manager.
`.trim();

                    const blob = new Blob([reportContent], { type: 'text/plain' });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `${reportName}-${new Date().toISOString().split('T')[0]}.txt`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);

                    showNotification('📄 Report Exported', `${reportName} downloaded successfully.`, 'success');
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }, 1000);
            });
        }

        // API Configuration
        const API_CONFIG = {
            pageSpeed: 'https://www.googleapis.com/pagespeedonline/v5/runPagespeed',
            pageSpeedKey: 'AIzaSyBVvR8Q_VqMVHCbvQGqG7LqVW0m8h6QDIY', // Replace with your API key
            siteUrl: window.location.origin
        };

        // Website Performance Functions with Real API Integration
        async function scanForErrors() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.disabled = true;
            btn.innerHTML = '🔄 Scanning...';

            try {
                // Get all links on the page to scan
                const links = Array.from(document.querySelectorAll('a[href]'))
                    .map(a => a.href)
                    .filter(href => href.startsWith(window.location.origin))
                    .slice(0, 20); // Limit to 20 URLs for demo

                const errors = [];
                let scannedCount = 0;

                // Scan each URL
                for (const url of links) {
                    try {
                        const response = await fetch(url, { method: 'HEAD', mode: 'no-cors' });
                        scannedCount++;

                        // Note: no-cors mode doesn't give us status codes, so we'll check differently
                        // In production, you'd use a backend service to scan URLs

                    } catch (error) {
                        errors.push({
                            url: url.replace(window.location.origin, ''),
                            code: 404,
                            message: 'Failed to fetch',
                            timestamp: 'Just now'
                        });
                    }
                }

                // Add stored errors from localStorage (simulating a monitoring service)
                const storedErrors = getStoredErrors();
                errors.push(...storedErrors);

                const error4xxCount = errors.filter(e => e.code >= 400 && e.code < 500).length;
                const error5xxCount = errors.filter(e => e.code >= 500).length;

                document.getElementById('error-4xx-count').textContent = error4xxCount;
                document.getElementById('error-5xx-count').textContent = error5xxCount;
                document.getElementById('pages-scanned').textContent = scannedCount || links.length;

                if (errors.length > 0) {
                    document.getElementById('errors-list').style.display = 'block';
                    document.getElementById('no-errors').style.display = 'none';

                    const container = document.getElementById('errors-container');
                    container.innerHTML = errors.map(error => `
                        <div style="display: flex; align-items: start; gap: var(--space-3); padding: var(--space-4); background: var(--gray-50); border-radius: var(--radius); margin-bottom: var(--space-3); border-left: 4px solid ${error.code >= 500 ? 'var(--apple-orange)' : 'var(--apple-red)'};">
                            <div style="font-size: 24px; font-weight: 700; color: ${error.code >= 500 ? 'var(--apple-orange)' : 'var(--apple-red)'};">${error.code}</div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; margin-bottom: var(--space-1); font-family: monospace; font-size: 13px;">${error.url}</div>
                                <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: var(--space-1);">${error.message}</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">${error.timestamp}</div>
                            </div>
                            <button onclick="fixError('${error.url.replace(/'/g, "\\'")})')" class="apple-btn btn-ghost" style="font-size: 12px; padding: var(--space-2) var(--space-3);">Fix</button>
                        </div>
                    `).join('');
                } else {
                    document.getElementById('errors-list').style.display = 'none';
                    document.getElementById('no-errors').style.display = 'block';
                }

                showNotification('✅ Scan Complete', `Found ${errors.length} errors across ${scannedCount || links.length} pages`, errors.length > 0 ? 'warning' : 'success');
            } catch (error) {
                console.error('Error scanning:', error);
                showNotification('❌ Scan Error', 'Failed to complete scan. Please try again.', 'error');
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        function getStoredErrors() {
            // Simulate stored errors from a monitoring service
            // In production, this would fetch from your backend
            return [
                { url: '/inventory/sedan-2024', code: 404, message: 'Page Not Found', timestamp: '2 hours ago' },
                { url: '/api/vehicle-details', code: 500, message: 'Internal Server Error', timestamp: '5 hours ago' },
                { url: '/images/banner.jpg', code: 404, message: 'Image Not Found', timestamp: '1 day ago' }
            ];
        }

        // Fetch real PageSpeed Insights data
        async function fetchPageSpeedData(url = API_CONFIG.siteUrl, strategy = 'mobile') {
            try {
                const apiUrl = `${API_CONFIG.pageSpeed}?url=${encodeURIComponent(url)}&strategy=${strategy}&key=${API_CONFIG.pageSpeedKey}`;
                const response = await fetch(apiUrl);

                if (!response.ok) {
                    throw new Error(`PageSpeed API error: ${response.status}`);
                }

                const data = await response.json();
                return {
                    score: Math.round(data.lighthouseResult.categories.performance.score * 100),
                    metrics: {
                        fcp: data.lighthouseResult.audits['first-contentful-paint'].displayValue,
                        lcp: data.lighthouseResult.audits['largest-contentful-paint'].displayValue,
                        cls: data.lighthouseResult.audits['cumulative-layout-shift'].displayValue,
                        tbt: data.lighthouseResult.audits['total-blocking-time'].displayValue,
                        si: data.lighthouseResult.audits['speed-index'].displayValue,
                        tti: data.lighthouseResult.audits['interactive'].displayValue
                    },
                    opportunities: data.lighthouseResult.audits
                };
            } catch (error) {
                console.error('PageSpeed API Error:', error);
                return null;
            }
        }

        // Update Core Web Vitals display with real data
        function updateCoreWebVitals() {
            const vitals = window.webVitalsData;

            // Update LCP
            if (vitals.lcp !== null) {
                const lcpValue = (vitals.lcp / 1000).toFixed(1);
                const isGood = lcpValue < 2.5;
                const isNeedsImprovement = lcpValue >= 2.5 && lcpValue < 4.0;
                const color = isGood ? 'var(--apple-green)' : isNeedsImprovement ? 'var(--apple-orange)' : 'var(--apple-red)';
                const status = isGood ? 'Good' : isNeedsImprovement ? 'Needs Improvement' : 'Poor';
                const progress = Math.min(100, (2.5 / parseFloat(lcpValue)) * 100);

                const lcpElement = document.querySelector('[data-metric="lcp"]');
                const lcpProgress = document.querySelector('[data-progress="lcp"]');
                const lcpStatus = document.querySelector('[data-status="lcp"]');

                if (lcpElement) {
                    lcpElement.textContent = `${lcpValue}s`;
                    lcpElement.style.color = color;
                }
                if (lcpProgress) {
                    lcpProgress.style.width = `${progress}%`;
                    lcpProgress.style.background = color;
                }
                if (lcpStatus) {
                    lcpStatus.textContent = status;
                    lcpStatus.style.color = color;
                }
            }

            // Update FID (or INP as fallback)
            const fidValue = vitals.fid !== null ? vitals.fid : vitals.inp;
            if (fidValue !== null) {
                const roundedFid = Math.round(fidValue);
                const isGood = roundedFid < 100;
                const isNeedsImprovement = roundedFid >= 100 && roundedFid < 300;
                const color = isGood ? 'var(--apple-green)' : isNeedsImprovement ? 'var(--apple-orange)' : 'var(--apple-red)';
                const status = isGood ? 'Good' : isNeedsImprovement ? 'Needs Improvement' : 'Poor';
                const progress = Math.min(100, (100 / roundedFid) * 100);

                const fidElement = document.querySelector('[data-metric="fid"]');
                const fidProgress = document.querySelector('[data-progress="fid"]');
                const fidStatus = document.querySelector('[data-status="fid"]');

                if (fidElement) {
                    fidElement.textContent = `${roundedFid}ms`;
                    fidElement.style.color = color;
                }
                if (fidProgress) {
                    fidProgress.style.width = `${progress}%`;
                    fidProgress.style.background = color;
                }
                if (fidStatus) {
                    fidStatus.textContent = status;
                    fidStatus.style.color = color;
                }
            }

            // Update CLS
            if (vitals.cls !== null) {
                const clsValue = vitals.cls.toFixed(3);
                const isGood = clsValue < 0.1;
                const isNeedsImprovement = clsValue >= 0.1 && clsValue < 0.25;
                const color = isGood ? 'var(--apple-green)' : isNeedsImprovement ? 'var(--apple-orange)' : 'var(--apple-red)';
                const status = isGood ? 'Good' : isNeedsImprovement ? 'Needs Improvement' : 'Poor';
                const progress = Math.min(100, (0.1 / parseFloat(clsValue)) * 100);

                const clsElement = document.querySelector('[data-metric="cls"]');
                const clsProgress = document.querySelector('[data-progress="cls"]');
                const clsStatus = document.querySelector('[data-status="cls"]');

                if (clsElement) {
                    clsElement.textContent = clsValue;
                    clsElement.style.color = color;
                }
                if (clsProgress) {
                    clsProgress.style.width = `${progress}%`;
                    clsProgress.style.background = color;
                }
                if (clsStatus) {
                    clsStatus.textContent = status;
                    clsStatus.style.color = color;
                }
            }
        }

        // Check SSL certificate
        async function checkSSL(domain = window.location.hostname) {
            // Note: Direct SSL checking requires backend service
            // For now, we'll check if HTTPS is enabled
            return {
                valid: window.location.protocol === 'https:',
                issuer: 'Let\'s Encrypt', // This would come from backend
                expiryDate: new Date(Date.now() + 90 * 24 * 60 * 60 * 1000).toLocaleDateString(), // Simulated
                grade: 'A+'
            };
        }

        // Initialize real-time monitoring
        function initializePerformanceMonitoring() {
            // Update Core Web Vitals every 5 seconds
            setInterval(updateCoreWebVitals, 5000);

            // Initial update
            setTimeout(updateCoreWebVitals, 2000);

            // Log performance data to backend (simulated)
            window.addEventListener('beforeunload', () => {
                const perfData = {
                    vitals: window.webVitalsData,
                    navigation: performance.getEntriesByType('navigation')[0],
                    timestamp: Date.now()
                };

                // In production, send to your backend
                console.log('Performance Data:', perfData);

                // Use sendBeacon for reliable delivery
                if (navigator.sendBeacon) {
                    const blob = new Blob([JSON.stringify(perfData)], { type: 'application/json' });
                    navigator.sendBeacon('/api/performance-metrics', blob);
                }
            });
        }

        // Start monitoring when page loads
        document.addEventListener('DOMContentLoaded', initializePerformanceMonitoring);

        function fixError(url) {
            showNotification('🔧 Fixing Error', `Analyzing ${url} and creating redirect...`, 'info');
            setTimeout(() => {
                showNotification('✅ Error Fixed', `Created 301 redirect for ${url}`, 'success');
            }, 2000);
        }

        function showRecommendationDetails(type) {
            const recommendations = {
                caching: {
                    title: 'Browser Caching Configuration',
                    description: 'Your static assets should have longer cache times to improve repeat visitor performance.',
                    impact: 'High',
                    effort: 'Low',
                    steps: [
                        'Add Cache-Control headers to static assets',
                        'Set max-age to 31536000 for immutable resources',
                        'Configure ETags for dynamic content',
                        'Test with Google PageSpeed Insights'
                    ],
                    affectedPages: ['/inventory', '/contact'],
                    estimatedImprovement: '+0.5s faster load for returning visitors'
                },
                lazy: {
                    title: 'Lazy Loading Implementation',
                    description: 'Defer loading of off-screen images until they\'re needed.',
                    impact: 'Medium',
                    effort: 'Low',
                    steps: [
                        'Add loading="lazy" attribute to images',
                        'Implement Intersection Observer for custom lazy loading',
                        'Prioritize above-the-fold images',
                        'Test on mobile connections'
                    ],
                    affectedPages: ['/inventory', '/gallery', '/about'],
                    estimatedImprovement: '+0.3s faster initial page load'
                }
            };

            const rec = recommendations[type];
            if (!rec) return;

            const html = `
                <div style="background: white; padding: var(--space-8); border-radius: var(--radius); max-width: 700px; margin: 20px;">
                    <h2 style="font-size: 24px; font-weight: 700; margin-bottom: var(--space-4);">${rec.title}</h2>
                    <p style="color: var(--text-secondary); margin-bottom: var(--space-6);">${rec.description}</p>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-4); margin-bottom: var(--space-6);">
                        <div style="padding: var(--space-4); background: var(--gray-50); border-radius: var(--radius);">
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--space-1);">Impact</div>
                            <div style="font-size: 18px; font-weight: 700; color: var(--apple-blue);">${rec.impact}</div>
                        </div>
                        <div style="padding: var(--space-4); background: var(--gray-50); border-radius: var(--radius);">
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--space-1);">Effort Required</div>
                            <div style="font-size: 18px; font-weight: 700; color: var(--apple-green);">${rec.effort}</div>
                        </div>
                    </div>

                    <div style="margin-bottom: var(--space-6);">
                        <h3 style="font-size: 16px; font-weight: 600; margin-bottom: var(--space-3);">Implementation Steps</h3>
                        <ol style="padding-left: var(--space-6); margin: 0;">
                            ${rec.steps.map(step => `<li style="margin-bottom: var(--space-2); color: var(--text-secondary);">${step}</li>`).join('')}
                        </ol>
                    </div>

                    <div style="padding: var(--space-4); background: rgba(0, 122, 255, 0.1); border-radius: var(--radius); margin-bottom: var(--space-6);">
                        <div style="font-weight: 600; margin-bottom: var(--space-2);">📈 Expected Improvement</div>
                        <div style="color: var(--text-secondary); font-size: 14px;">${rec.estimatedImprovement}</div>
                    </div>

                    <div style="margin-bottom: var(--space-6);">
                        <div style="font-size: 14px; font-weight: 600; margin-bottom: var(--space-2);">Affected Pages (${rec.affectedPages.length})</div>
                        <div style="display: flex; gap: var(--space-2); flex-wrap: wrap;">
                            ${rec.affectedPages.map(page => `<span style="padding: var(--space-1) var(--space-3); background: var(--gray-100); border-radius: var(--radius-full); font-size: 12px; font-family: monospace;">${page}</span>`).join('')}
                        </div>
                    </div>

                    <div style="display: flex; gap: var(--space-3);">
                        <button onclick="implementRecommendation('${type}')" class="apple-btn btn-primary" style="flex: 1;">Implement Now</button>
                        <button onclick="closePreview()" class="apple-btn btn-secondary" style="flex: 1;">Close</button>
                    </div>
                </div>
            `;

            showPreviewModal(html);
        }

        function implementRecommendation(type) {
            closePreview();
            showNotification('🚀 Implementation Started', `Applying ${type} optimization...`, 'info');
            setTimeout(() => {
                showNotification('✅ Implementation Complete', 'Optimization has been applied successfully!', 'success');
            }, 3000);
        }

        function showNotification(title, message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: white;
                border: 1px solid var(--gray-200);
                border-radius: var(--radius);
                padding: var(--space-4);
                box-shadow: var(--shadow-lg);
                z-index: 1000;
                min-width: 300px;
                transform: translateX(400px);
                transition: transform 0.3s ease;
            `;

            const colors = {
                success: 'var(--apple-green)',
                info: 'var(--apple-blue)',
                warning: 'var(--apple-orange)',
                error: 'var(--apple-red)'
            };

            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: var(--space-3);">
                    <div style="width: 4px; height: 40px; background: ${colors[type]}; border-radius: 2px;"></div>
                    <div>
                        <div style="font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-1);">${title}</div>
                        <div style="font-size: 13px; color: var(--text-secondary);">${message}</div>
                    </div>
                </div>
            `;

            document.body.appendChild(notification);

            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);

            // Auto remove
            setTimeout(() => {
                notification.style.transform = 'translateX(400px)';
                setTimeout(() => document.body.removeChild(notification), 300);
            }, 4000);
        }

        function downloadReport(data) {
            const report = `
DealershipAI Executive Report
Generated: ${data.date}

VISIBILITY PERFORMANCE
=====================
SEO Visibility: ${data.metrics.seoVisibility}
AEO Visibility: ${data.metrics.aeoVisibility}
GEO Visibility: ${data.metrics.geoVisibility}

KEY METRICS
===========
Revenue at Risk: ${data.metrics.revenueAtRisk}
Search Visibility: ${data.metrics.searchVisibility}
Website Health: ${data.metrics.websiteHealth}

EXECUTIVE SUMMARY
================
Your dealership's digital visibility is performing well across traditional search channels with strong SEO performance at 87.3%. However, there are significant opportunities in AI-driven search optimization, particularly in Generative Engine Optimization (GEO) which shows room for improvement at 65.2%.

RECOMMENDATIONS
===============
1. Immediate focus on AI citation optimization
2. Enhanced schema markup implementation
3. Improved content strategy for AI platforms
4. Regular monitoring of emerging AI search channels

For detailed analysis and implementation support, contact your DealershipAI success manager.
            `.trim();

            const blob = new Blob([report], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `DealershipAI-Executive-Report-${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                // Initialize API service
                const apiService = new DealershipAI_API();

                // Initialize dashboard tabs
                const dashboardTabs = new DashboardTabs(apiService);
                await dashboardTabs.initialize();

                // Initialize real-time manager
                const realTimeManager = new RealTimeManager(apiService);
                await realTimeManager.initialize();

                // Store managers globally for access
                window.dashboardManager = {
                    api: apiService,
                    tabs: dashboardTabs,
                    realTime: realTimeManager
                };

                // Initialize base dashboard
                initializeDashboard();

                console.log('🚀 DealershipAI Dashboard fully initialized with API integration and real-time updates');
            } catch (error) {
                console.error('❌ Failed to initialize dashboard:', error);
            }
        });

        // Close modal on backdrop click
        document.addEventListener('click', function(event) {
            if (event.target.classList.contains('cupertino-modal')) {
                closeModal(event.target.id);
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const openModal = document.querySelector('.cupertino-modal.show');
                if (openModal) {
                    closeModal(openModal.id);
                }
            }
        });

        // Add subtle hover effects to cards
        document.querySelectorAll('.apple-card.clickable').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-4px)';
            });

            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });
    </script>

    <!-- API Integration Scripts -->
    <script src="api-config.js"></script>
    <script src="dashboard-tabs.js"></script>
    <script src="real-time-updates.js"></script>
    <!-- CTA Handlers Script -->
    <script src="cta-handlers.js"></script>
</body>
</html>