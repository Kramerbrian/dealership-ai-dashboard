# üöÄ DealershipAI Production Deployment Guide

Complete step-by-step guide to deploy your DealershipAI dashboard to production.

## üìã **Prerequisites**

- Node.js 18+ installed
- Vercel CLI installed (`npm i -g vercel`)
- Stripe account with API keys
- Supabase account with project
- Custom domain (optional but recommended)

## üè™ **Step 1: Configure Stripe Products**

### 1.1 Run the Stripe Setup Script

```bash
# Install dependencies
npm install

# Run Stripe product setup
node scripts/setup-stripe-products.js
```

This will:
- Create "Pro Plan" ($599/month, $5990/year)
- Create "Premium+ Plan" ($999/month, $9990/year)
- Generate price IDs for your environment variables

### 1.2 Update Environment Variables

Add the generated price IDs to your `.env` file:

```bash
# Stripe Price IDs (generated by setup script)
STRIPE_PRICE_ID_PRO_MONTHLY=price_xxx
STRIPE_PRICE_ID_PRO_ANNUAL=price_xxx
STRIPE_PRICE_ID_PREMIUM_MONTHLY=price_xxx
STRIPE_PRICE_ID_PREMIUM_ANNUAL=price_xxx
```

### 1.3 Configure Stripe Webhooks

1. Go to Stripe Dashboard ‚Üí Webhooks
2. Add endpoint: `https://your-domain.com/api/webhooks/stripe`
3. Select events:
   - `checkout.session.completed`
   - `customer.subscription.created`
   - `customer.subscription.updated`
   - `customer.subscription.deleted`
   - `invoice.payment_failed`
4. Copy webhook signing secret to `STRIPE_WEBHOOK_SECRET`

## üß™ **Step 2: Run Comprehensive Tests**

### 2.1 Install Test Dependencies

```bash
npm install --save-dev node-fetch
```

### 2.2 Run Test Suite

```bash
# Run all tests
node scripts/run-tests.js

# Expected output: All tests should pass
# ‚úÖ Passed: 15
# ‚ùå Failed: 0
# üìä Success Rate: 100%
```

### 2.3 Fix Any Issues

If tests fail:
1. Check environment variables are set correctly
2. Ensure all API keys are valid
3. Verify database connections
4. Re-run tests until all pass

## üöÄ **Step 3: Deploy to Production**

### 3.1 Login to Vercel

```bash
vercel login
```

### 3.2 Configure Environment Variables

Set all required environment variables in Vercel:

```bash
# Required variables
STRIPE_SECRET_KEY=sk_live_xxx
STRIPE_PUBLISHABLE_KEY=pk_live_xxx
STRIPE_WEBHOOK_SECRET=whsec_xxx
STRIPE_PRICE_ID_PRO_MONTHLY=price_xxx
STRIPE_PRICE_ID_PRO_ANNUAL=price_xxx
STRIPE_PRICE_ID_PREMIUM_MONTHLY=price_xxx
STRIPE_PRICE_ID_PREMIUM_ANNUAL=price_xxx
SUPABASE_URL=https://xxx.supabase.co
SUPABASE_ANON_KEY=eyJhbGc...
SUPABASE_SERVICE_KEY=eyJhbGc...
NEXT_PUBLIC_URL=https://your-domain.com

# Optional variables
OPENAI_API_KEY=sk-xxx
GOOGLE_ANALYTICS_API_KEY=xxx
FACEBOOK_ACCESS_TOKEN=xxx
YELP_API_KEY=xxx
```

### 3.3 Deploy to Vercel

```bash
# Deploy to production
node scripts/deploy-production.js

# Or manually:
vercel --prod
```

### 3.4 Configure Custom Domain

1. Go to Vercel Dashboard ‚Üí Your Project ‚Üí Settings ‚Üí Domains
2. Add your custom domain
3. Update DNS records as shown in Vercel
4. Wait for SSL certificate (up to 24 hours)

## üåê **Step 4: Domain Configuration**

### 4.1 DNS Setup

Add these DNS records to your domain registrar:

```dns
# Apex domain
Type: A
Name: @
Value: 76.76.19.61

# CNAME for www
Type: CNAME
Name: www
Value: cname.vercel-dns.com
```

### 4.2 Update Environment Variables

Update `NEXT_PUBLIC_URL` to your custom domain:

```bash
NEXT_PUBLIC_URL=https://your-domain.com
```

### 4.3 Update Stripe Webhook URL

1. Go to Stripe Dashboard ‚Üí Webhooks
2. Update webhook URL to: `https://your-domain.com/api/webhooks/stripe`
3. Test webhook delivery

## üìä **Step 5: Monitor Performance**

### 5.1 Run Performance Monitoring

```bash
# Check system health
node scripts/monitor-performance.js
```

### 5.2 Set Up Continuous Monitoring

Create a cron job to run monitoring every 5 minutes:

```bash
# Add to crontab
*/5 * * * * cd /path/to/dealership-ai-dashboard && node scripts/monitor-performance.js
```

### 5.3 Set Up Alerts

Configure alerts for:
- Uptime below 99%
- Response time above 3 seconds
- Error rate above 5%
- Database connectivity issues

## üîß **Step 6: Post-Deployment Configuration**

### 6.1 Test All Features

1. **Homepage**: Visit your domain
2. **Pricing Page**: Test both Pro and Premium+ plans
3. **Checkout Flow**: Complete test purchases
4. **Analysis**: Run dealership analysis
5. **Chatbot**: Test AI assistant
6. **Notifications**: Verify real-time alerts

### 6.2 Configure Analytics

1. **Google Analytics**: Add tracking code
2. **Stripe Dashboard**: Monitor payments
3. **Supabase Dashboard**: Monitor database
4. **Vercel Analytics**: Enable in dashboard

### 6.3 Set Up Error Tracking

1. **Sentry**: Add error tracking
2. **Logging**: Configure log aggregation
3. **Monitoring**: Set up uptime monitoring

## üì± **Step 7: Mobile & PWA Setup**

### 7.1 Test Mobile Responsiveness

- Test on various devices
- Verify touch interactions
- Check mobile navigation

### 7.2 Configure PWA

1. Update `public/manifest.json`
2. Add service worker
3. Test offline functionality
4. Verify home screen installation

## üîí **Step 8: Security & Compliance**

### 8.1 Security Headers

Verify security headers are active:
- Content Security Policy
- X-Frame-Options
- X-Content-Type-Options
- Strict-Transport-Security

### 8.2 Data Protection

1. **GDPR Compliance**: Add privacy policy
2. **Data Encryption**: Verify all data is encrypted
3. **Access Control**: Review user permissions
4. **Audit Logs**: Enable comprehensive logging

## üìà **Step 9: Performance Optimization**

### 9.1 Enable Caching

1. **CDN**: Configure Vercel CDN
2. **Browser Caching**: Set cache headers
3. **API Caching**: Implement response caching

### 9.2 Optimize Images

1. **WebP Format**: Convert images to WebP
2. **Lazy Loading**: Implement lazy loading
3. **Responsive Images**: Use appropriate sizes

### 9.3 Database Optimization

1. **Indexes**: Ensure proper indexing
2. **Queries**: Optimize database queries
3. **Connection Pooling**: Configure connection limits

## üÜò **Step 10: Troubleshooting**

### Common Issues

1. **Deployment Fails**
   - Check environment variables
   - Verify Vercel CLI is updated
   - Check build logs

2. **Stripe Webhooks Not Working**
   - Verify webhook URL is correct
   - Check webhook secret
   - Test webhook delivery

3. **Database Connection Issues**
   - Verify Supabase credentials
   - Check network connectivity
   - Review RLS policies

4. **Custom Domain Not Working**
   - Check DNS propagation
   - Verify SSL certificate
   - Wait up to 24 hours

### Debug Commands

```bash
# Check deployment status
vercel ls

# View deployment logs
vercel logs [deployment-url]

# Test API endpoints
curl -X POST https://your-domain.com/api/checkout \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","dealershipUrl":"https://example.com","plan":"monthly","tier":"starter"}'

# Check performance
node scripts/monitor-performance.js
```

## ‚úÖ **Step 11: Go Live Checklist**

- [ ] All tests passing
- [ ] Stripe products configured
- [ ] Custom domain active
- [ ] SSL certificate installed
- [ ] Webhooks working
- [ ] Database connected
- [ ] Performance optimized
- [ ] Monitoring active
- [ ] Error tracking configured
- [ ] Analytics tracking
- [ ] Mobile responsive
- [ ] Security headers active
- [ ] Backup strategy in place

## üéâ **You're Live!**

Your DealershipAI dashboard is now live and ready to serve customers!

### Key URLs:
- **Main Site**: https://your-domain.com
- **Pricing**: https://your-domain.com/pricing.html
- **Dashboard**: https://your-domain.com/dashboard
- **API**: https://your-domain.com/api/checkout

### Next Steps:
1. Monitor performance daily
2. Respond to customer feedback
3. Iterate and improve features
4. Scale as needed

**Happy analyzing!** üöÄ
